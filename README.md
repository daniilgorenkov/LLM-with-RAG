# LLM-with-RAG: RAG-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤ –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã—Ö –∫–æ–ª—ë—Å–Ω—ã—Ö –ø–∞—Ä üöÇü§ñ
Python License: MIT Stars

End-to-end Retrieval-Augmented Generation (RAG) –ø–∞–π–ø–ª–∞–π–Ω –Ω–∞ –±–∞–∑–µ LLM –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –Ω–∞—É—á–Ω—ã–º —Å—Ç–∞—Ç—å—è–º –≤ –¥–æ–º–µ–Ω–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –∫–∞—Ç–∞–Ω–∏—è –∂–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã—Ö –∫–æ–ª—ë—Å (wheel flat, shelling, cracks –∏ —Ç.–¥.). –ü—Ä–æ–µ–∫—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫, —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é QA-–¥–∞—Ç–∞—Å–µ—Ç–∞ –∏ LoRA-—Ñ–∞–π–Ω—Ç—é–Ω–∏–Ω–≥ –º–æ–¥–µ–ª–∏.

–°–≤—è–∑–∞–Ω —Å –º–æ–µ–π –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–µ–π –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é ML-—Å–∏—Å—Ç–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∫–æ–ª—ë—Å–Ω—ã—Ö –ø–∞—Ä –≤ –ø–æ–¥–≤–∏–∂–Ω–æ–º —Å–æ—Å—Ç–∞–≤–µ (–ü–ì–£–ü–°, –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥).

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ
–¶–µ–ª—å: –°–æ–∑–¥–∞—Ç—å RAG-—Å–∏—Å—Ç–µ–º—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ —Å—Ç–∞—Ç—å—è–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ö–∞–∫–∏–µ –º–æ–¥–µ–ª–∏ YOLO –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏?"), –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
–î–æ–º–µ–Ω: –ò–ò/ML –¥–ª—è –∂/–¥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ (–≤–∏–±—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑, –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ, CNN, YOLO).
–ö–ª—é—á–µ–≤—ã–µ —Ñ–∏—á–∏:
–ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ PDF ‚Üí Markdown —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (pymupdf4llm).
–ß–∞–Ω–∫–∏–Ω–≥, –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (FAISS + multilingual-e5-base).
–°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π QA-–¥–∞—Ç–∞—Å–µ—Ç (~50 –ø—Ä–∏–º–µ—Ä–æ–≤) —Å –æ—Ü–µ–Ω–∫–æ–π –∫–∞—á–µ—Å—Ç–≤–∞ (faithfulness 0.90, answer relevancy 0.90).
LoRA-—Ñ–∞–π–Ω—Ç—é–Ω–∏–Ω–≥ LLM (PEFT, SFTTrainer, 4-bit –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ) –Ω–∞ –¥–æ–º–µ–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ.
–≠—Ç–æ –º–æ–π –ª–∏—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –Ω–∏—à—É LLM/RAG (–¥–µ–∫–∞–±—Ä—å 2025 ‚Äî ongoing).

## üõ†Ô∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
–î–æ–∫—É–º–µ–Ω—Ç—ã: pymupdf4llm, pathlib
–≠–º–±–µ–¥–¥–∏–Ω–≥–∏ & –†–µ—Ç—Ä–∏–≤–∞–ª: Sentence-Transformers (intfloat/multilingual-e5-base), FAISS
LLM/–§–∞–π–Ω—Ç—é–Ω: Hugging Face Transformers, PEFT (LoRA), TRL (SFTTrainer), BitsAndBytes (4-bit)
–î–∞–Ω–Ω—ã–µ: Datasets (Hugging Face), JSONL –¥–ª—è QA
–û—Ü–µ–Ω–∫–∞: cosine similarity, sklearn
–î—Ä—É–≥–æ–µ: Python 3.10+, Docker (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –¥–µ–ø–ª–æ—è)

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞
Ingestion: PDF ‚Üí Markdown ‚Üí –ß–∞–Ω–∫–∏ ‚Üí –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ ‚Üí FAISS-–∏–Ω–¥–µ–∫—Å.
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö: LLM –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞ QA (question, answer, contexts).
–û—Ü–µ–Ω–∫–∞: –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ö–æ–¥—Å—Ç–≤–æ (faithfulness, relevancy >0.85).
–§–∞–π–Ω—Ç—é–Ω: LoRA –Ω–∞ 4-bit –º–æ–¥–µ–ª–∏ (max_steps=500, fp16).
Inference: RAG-—Ü–µ–ø–æ—á–∫–∞ (LangChain-style) –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤.
–ü–∞–π–ø–ª–∞–π–Ω 

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
–ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```
git clone https://github.com/daniilgorenkov/LLM-with-RAG.git
cd LLM-with-RAG
```
–°–æ–∑–¥–∞–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

```
python -m venv .venv
source .venv/bin/activate
```

–£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```pip install -r requirements.txt```


## üìà –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
1. –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

```python preprocessor/run.py --all
–í—Ö–æ–¥: PDF –≤ data/raw_docs.
–í—ã—Ö–æ–¥: Markdown –≤ data/clean_docs.
```
2. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞

```python rag/index_builder/build_index.py```
–°–æ–∑–¥–∞—ë—Ç index.faiss —Å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ —á–∞–Ω–∫–æ–≤.
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QA-–¥–∞—Ç–∞—Å–µ—Ç–∞

```python rag/dataset_builder/qa_builder.py```
–í—ã—Ö–æ–¥: qa_dataset.jsonl (~50 –ø—Ä–∏–º–µ—Ä–æ–≤).
4. –û—Ü–µ–Ω–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

```python rag/dataset_builder/qa_checker.py```
–ú–µ—Ç—Ä–∏–∫–∏: faithfulness ~0.90, overall score ~0.88.
5. LoRA-—Ñ–∞–π–Ω—Ç—é–Ω

```python train/train.py```
–¢—Ä–µ–Ω–∏—Ä—É–µ—Ç LoRA –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ (500 —à–∞–≥–æ–≤).
6. RAG-–∏–Ω—Ñ–µ—Ä–µ–Ω—Å

```python rag/inference.py --query "–ö–∞–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ YOLOv5 –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ wheel flats?"```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç —Å —Ü–∏—Ç–∞—Ç–∞–º–∏ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –º–µ—Ç—Ä–∏–∫–∏
QA-–¥–∞—Ç–∞—Å–µ—Ç: 42‚Äì58 –ø—Ä–∏–º–µ—Ä–æ–≤, faithfulness 0.900, answer relevancy 0.904, context relevancy 0.838.
–§–∞–π–Ω—Ç—é–Ω: Trainable params ~1M (0.07% –æ—Ç –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏), –≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ RAG.
–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –Ω–∞ GPU ~10x –±—ã—Å—Ç—Ä–µ–µ, —Ä–µ—Ç—Ä–∏–≤–∞–ª recall >80% –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö.

## üîó –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏
–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–µ–π: https://github.com/daniilgorenkov/Dissertation (ML –¥–ª—è –∂/–¥ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏).
–ü–æ—Ö–æ–∂–∏–µ –Ω–∞–≤—ã–∫–∏: RAG/LLM –≤ https://github.com/daniilgorenkov/DL.
ü§ù –ö–æ–Ω—Ç—Ä–∏–±—å—é—Ç–∏–Ω–≥
–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é PR! –§–æ—Ä–∫–Ω–∏, —Å–æ–∑–¥–∞–π issue –∏–ª–∏ –Ω–∞–ø–∏—à–∏ –º–Ω–µ –≤ TG: @DaniilGorenkov.

üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
MIT License. –°–º. LICENSE.

–ö–æ–Ω—Ç–∞–∫—Ç—ã: gorenkov.daniil@gmail.com | GitHub: @daniilgorenkov | telegram: @DaniilGorenkov.