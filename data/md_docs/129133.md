Article citation info: 

Olejniczak T. Application of 1D convolutional neural networks for anomaly detection in resistance measurements of railway wheelsets. 

Rail Vehicles/Pojazdy Szynowe. 2025;1-2:27-31. https://doi.org/10.53502/RAIL-209994 

**==> picture [51 x 71] intentionally omitted <==**

## **Rail Vehicles/Pojazdy Szynowe** 

www.railvehicles.eu 

## **Application of 1D convolutional neural networks for anomaly detection in resistance measurements of railway wheelsets** 

## Tomasz **Olejniczak**[*] 

> a _Łukasiewicz Research Network – Poznan Institute of Technology, 6 Ewarysta Estkowskiego St., 61-755 Poznań, Poland_ 

|ARTICLEINFO|_The article presents the application of convolutional neural networks (CNN) for the_| |---|---| ||_classification of electrical resistance measurements of railway wheelsets. The aim of the_| |Received: 13 June 2025|_study was to develop a model capable of automatically detecting incorrect measurement_| |Revised: 12 August 2025<br>Accepted: 28 August 2025<br>Available online: 27 September 2025|_results based on data obtained from various measurement configurations. The training_<br>_process used experimental data collected under real-world conditions. The developed_<br>_model achieved high classification accuracy and was tested on variable-length data. The_| |KEYWORDS|_study demonstrates that CNN-based methods can be effectively applied in the diagnostics_| ||_of measurement systems._| |resistance|| |electrical measurements|| |convolutional neutral networks|| |neural network|| |wheelset|This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/)|



## **1. Introduction** 

The accuracy and reliability of wheelset resistance measurements are critical for the safe operation of rail vehicles and for proper interaction with detection systems based on the short-circuiting of track circuits by the vehicle’s wheelsets, which are used in railway traffic control (RTC). These measurements are subject to various types of disturbances and errors arising from material inhomogeneity (e.g. of the probe or wheel material) and changing electrical contact conditions (e.g. contamination). 

In traditional data analysis, error detection is typically based on fixed thresholds or statistical analysis. However, in cases of high data variability, these methods may prove insufficient. An alternative approach involves the use of artificial intelligence methods, including convolutional neural networks (CNNs), which are known for their high effectiveness in classification and pattern recognition tasks. 

Choi et al. [1] presented a method for detecting rail surface defects using a Fast R-CNN model designed for object detection in images. They worked on a dataset composed of rail surface images, which, once 

classified, formed a database of defect and non-defect images. In [8], an improved version of Mask R-CNN was introduced for rail defect detection, achieving very high accuracy (mAP 98.7%) through the use of feature fusion (DFPN) and the CIoU metric. This method allows for precise detection of even minor defects without significantly increasing computational complexity. Jwo [3] proposed an intelligent press-fit assembly support system for wheelsets (wheel mounting on axles) based on deep learning. The authors used moment and displacement data during the pressfitting process to assess assembly quality. These data were processed using LSTM and CNN models, which classified operations as ‘correct’ or ‘faulty’. The system demonstrated the ability to detect mounting issues early, enabling the elimination of defective components and improving fleet reliability. In [12], for wheel slip detection, the authors proposed a hybrid approach based on operational data, combining unsupervised and supervised learning methods. 

Considering the growing trend of using neural networks in railway applications, a CNN model was developed and tested to classify wheelset resistance measurement results as either valid or faulty. The 

> * Corresponding author: tomasz.olejniczak@pit.lukasiewicz.gov.pl (T. Olejniczak) 

27 

_Application of 1D convolutional neural networks for anomaly detection…_ 

model is based on real measurement data collected using a milliohmmeter operating in a four-wire Kelvin configuration, across various measurement setups: symmetric points, variable probe positions, and swapped wiring. The trained model was ultimately applied to the analysis of new, previously unlabelled measurement data. 

## **2. Methodology** 

To classify the results of wheelset resistance measurements, an approach based on convolutional neural networks (CNN) was applied. The networks were implemented in Python using the TensorFlow library. The process of data preparation, model construction, and training was carried out in several stages: 

## **2.1. Data preparation** 

The training data were collected during real-world measurements of wheelset resistance in various configurations: 


- measurements at symmetrical points on the tread surface and the flange of the wheel 


- sweeping one measurement probe along the wheel while keeping the other probe stationary 


- swapping the measurement leads in the probes to assess the influence of polarity on the measurement results. 

The measurement results were saved in CSV format, with each column representing one measurement. The last row of the dataset contained classification labels (0 – correct measurement, 1 – incorrect measurement). The data were normalized using standardization (StandardScaler) and then reshaped into a three-dimensional format required by the input layer of the CNN model (samples, number of measurement points, channel = 1). 

## **2.2. CNN model architecture** 

The neural network model consisted of two onedimensional convolutional layers (Conv1D), each followed by a batch normalization layer (BatchNormalization) and a max pooling layer (MaxPooling1D). Below is the representation of the 1D convolution operation used in the CNN: 

**==> picture [200 x 14] intentionally omitted <==**

where: x – input signal, w – convolution kernel (filter), k – kernel length, t – sample position index. 

After data flattening (Flatten), a dense layer (Dense) and a dropout layer (Dropout) were added to reduce the risk of overfitting. The final layer used the sigmoid activation function, enabling binary classification. 

## **2.3. Model training** 

The model was trained using data from various measurement configurations. The training process employed the Adam optimization algorithm and the binary cross-entropy loss function. The binary crossentropy loss is defined as follows: 

**==> picture [245 x 19] intentionally omitted <==**

where: yᵢ – true label of the sample, ŷᵢ – predicted probability from the classifier, N – number of samples. 

To prevent overfitting, the EarlyStopping mechanism was used, which halted training after several epochs without improvement in the validation loss. Class imbalance was also addressed by applying class weights (class_weight). Figure 1 shows an example of the model's accuracy plot over successive training epochs. It compares the accuracy on the training and validation sets, allowing an assessment of whether the model is learning properly and if overfitting occurs. 

**==> picture [238 x 157] intentionally omitted <==**

Fig. 1. Accuracy of the CNN model across epochs for one of the model configurations during model training 

Figure 2 shows how the model's prediction probabilities are distributed across all samples. The X-axis represents the probability assigned to a class, while the Y-axis shows the number of samples with that probability. This allows for an assessment of the model's confidence and the identification of potential misclassifications or uncertain predictions. 

**==> picture [242 x 119] intentionally omitted <==**

Fig. 2. Probability of error for one of the model configurations during model training 

28 

RAIL VEHICLES/POJAZDY SZYNOWE 1-2, 2025 

_Application of 1D convolutional neural networks for anomaly detection…_ 

## **2.4. Model testing** 

After the training process was completed, the model was saved in the .keras format. A separate script was prepared for testing, allowing the analysis of new measurement data – even when the input samples had variable lengths. Through appropriate preprocessing steps (zero-padding or trimming), the test data could be analyzed while maintaining compatibility with the model’s input requirements. The figure below presents a general overview of the CNN model architecture. 

**==> picture [238 x 91] intentionally omitted <==**

Fig. 3. General CNN model architecture 

The described approach enables fast and accurate classification of resistance measurement results and can be adapted to various measurement configurations. 

## **3. Research results** 

To evaluate the effectiveness of the developed CNN model, training was performed using wheelset resistance measurement data covering various experimental configurations. The training dataset contained 834 samples, of which 482 were labeled as incorrect. The model achieved high accuracy after several dozen epochs, and the EarlyStopping mechanism terminated the training once optimal parameters were reached. Figure 4 presents the model's accuracy plot over successive training epochs for the final CNN model. 

**==> picture [242 x 159] intentionally omitted <==**

Fig. 4. Target CNN model accuracy 

Figure 5 shows the distribution of the model's prediction probabilities across all samples for the final CNN model. 

**==> picture [238 x 116] intentionally omitted <==**

Fig. 5. Error probability 

After completing the training, the model was applied to a new set of unlabeled measurement data. Each sample was classified along with a calculated error probability. An example result: 


- Sample 1: Probability = 0.0032 → Prediction: 0 (correct) 


- Sample 2: Probability = 0.9811 → Prediction: 1 (incorrect) 

The model demonstrated a high classification accuracy of 95%, particularly for test samples with a structure similar to the training data. For a second dataset, derived from a different measurement configuration, the model's accuracy was slightly lower, suggesting the need to further expand or unify the training dataset. 

To improve prediction quality, the impact of various hyperparameters was tested, including: 


- the number of filters in the Conv1D layers 


- kernel sizes 


- dropout values 


- number of epochs and batch size. 

The best performance was achieved with the following configuration: 


- 2 Conv1D layers (64 and 128 filters) 


- convolutional kernel size of 5 


- dropout = 0.5 


- Adam optimizer 


- batch size = 2. 

The classifier’s performance was also verified by calculating accuracy, precision, and recall. For the test dataset, the following results were achieved (Table 1). 

Table 1. Classifier effectiveness 

|Class|Precision|Recall|F1-score|Support| |---|---|---|---|---| |0 (correct)|0.89|1.00|0.94|8| |1 (incorret)|1.00|0.94|0.97|16|



RAIL VEHICLES/POJAZDY SZYNOWE 1-2, 2025 

29 

_Application of 1D convolutional neural networks for anomaly detection…_ 

Which translates to: 


- Accuracy: 96% 


- Precision: 94% 


- Recall: 97% 


- F1-score: 95%. 

## **4. Discussion** 

The obtained results confirm the effectiveness of using convolutional neural networks for the classification of wheelset resistance measurement data. The CNN model, trained on a dataset that included various measurement configurations (symmetrical points, probe sweeping, lead swapping), successfully learned to distinguish between correct and incorrect results. 

The model’s high accuracy, achieved after only several dozen epochs, indicates both the good quality of the training data and the suitability of the network architecture. Particularly important were the use of data normalization and the EarlyStopping mechanism, which helped prevent overfitting. 

However, it was observed that when applying the model to data obtained under different measurement conditions, the prediction accuracy could deteriorate. This is most likely due to the limited diversity of the training dataset. In practice, this suggests that to obtain a stable and generalizable model, it may be necessary to collect a larger number of samples from various measurement environments. 

An important advantage of the proposed approach is the ability to classify new measurement data without the need for manual interpretation. The model is capable of automatically identifying samples that are likely to contain errors, which can be used in diagnostic systems or for the automatic rejection of faulty measurements. 

In the future, the model can be further improved by: 


- expanding the dataset to include other types of disturbances 

## **Nomenclature** 

AI artificial intelligence CIoU complete intersection over union CNN convolutional neural networks DFPN double feature pyramid network Fast R-CNN fast region-based convolutional network method 

## **Bibliography** 


- [1] Choi J-Y, Han J-M. Deep learning (Fast R-CNN)-based evaluation of rail surface defects. Appl Sci. 2024;14(5): 1874. https://doi.org/10.3390/app14051874 


- applying data augmentation techniques 


- implementing a multi-class classifier for different types of measurement errors 


- deploying the solution to edge environments (edge AI) in measurement devices. 

## **4. Summary** 

In this study, a convolutional neural network (CNN) model was developed and validated for the classification of wheelset resistance measurement results as either correct or incorrect. The model was trained on real-world data obtained from various measurement configurations. 

The key findings of the study are as follows: 


- High classification accuracy – the model achieved over 95% accuracy on validation data, confirming its usefulness in detecting incorrect measurements. 


- Generalization capability – despite a limited number of samples, the model was able to correctly classify measurement data not included in the training set, provided their characteristics did not differ significantly from the training data. 


- Practical applicability – the proposed approach enables automatic support for the diagnostics of wheelset resistance measurements and can be integrated with existing measurement systems. 


- Potential for further development – increasing the number of samples, diversifying the dataset, and adapting the model to other electrical parameters (e.g. impedance) may broaden the scope of application. 

The developed tool represents a first step toward the implementation of machine learning in quality control and measurement verification under realworld conditions. It may serve as a foundation for further research in the field of railway vehicle condition monitoring. 

LSTM long short-term memory mAP mean average precision Mask R-CNN mask region-based convolutional neural network RTC railway traffic control 


- [2] Hardwick C, Lewis S, Lewis R. The effect of friction modifiers on wheel/rail isolation at low axle loads. P I Mech Eng F-J Rai. 2014;228(7):768-783. https://doi.org/10.1177/0954409713488102 

30 

RAIL VEHICLES/POJAZDY SZYNOWE 1-2, 2025 

_Application of 1D convolutional neural networks for anomaly detection…_ 


- [3] Jwo J-S, Lin C-S, Lee C-H, Zhang L, Huang S-M. Intelligent system for railway wheelset press-fit inspection using deep learning. Appl Sci. 2021;11(17):8243. https://doi.org/10.3390/app11178243 

 - wheelset bearings in high-speed trains. IEEE Access. 2019;7: 10278-10293. 

 - https://doi.org/10.1109/ACCESS.2018.2888842 

 - [10] Shafique R, Siddiqui H-U-R, Rustam F, Ullah S, Siddique MA, Lee E et al. A novel approach to railway track faults detection using acoustic analysis. Sensors. 2021;21(18):6221. https://doi.org/10.3390/s21186221 


- [4] Li H, Wang H, Xie Z, He M. Fault diagnosis of railway freight car wheelset based on deep belief network and cuckoo search algorithm. P I Mech Eng F-J Rai. 2021;236(5):501510. https://doi.org/10.1177/09544097211029155 

 - [11] Shaikh K, Hussain I, Chowdhry BS. Wheel defect detection using a hybrid deep learning approach. Sensors. 2023;23(14): 6248. https://doi.org/10.3390/s23146248 


- [5] Liu S, Wang Q, Luo Y, A review of applications of visual inspection technology based on image processing in the railway industry. Transportation Safety and Environment. 2019; 1(3):185-204. https://doi.org/10.1093/tse/tdz007 

 - [12] Wang H, Li M, Wan Z. Rail surface defect detection based on improved mask R-CNN. Comput Electr Eng. 2022;102: 108269. https://doi.org/10.1016/j.compeleceng.2022.108269 

 - [13] Wu P, Zhang F, Wang J, Wei L, Huo W. Review of wheel-rail forces measuring technology for railway vehicles. Adv Mech Eng. 2023;15(3):1-15. https://doi.org/10.1177/16878132231158991 


- [6] Mosleh A, Montenegro PA, Costa PA, Calçada R. Railway vehicle wheel flat detection with multiple records using spectral kurtosis analysis. Appl Sci. 2021;11(9):4002. https://doi.org/10.3390/app11094002 


- [7] Mohammadi S, Sattarpanah Karganroudi S, Adda M, Ibrahim H. Rail defect classification with deep learning method. Green Energy and Intelligent Transportation. 2025;100332. https://doi.org/10.1016/j.geits.2025.100332 

 - [14] Ye Y, Huang P, Zhang Y. Deep learning-based fault diagnostic network of high-speed train secondary suspension systems for immunity to track irregularities and wheel wear. Rail Eng Science. 2022;30:96-116. https://doi.org/10.1007/s40534-021-00252-z 


- [8] Namoano B, Emmanouilidis C, Starr A. Detecting wheel slip from railway operational data through a combined wavelet, long short-term memory and neural network classification method. Eng Appl Artif Intel. 2024;137(Part B):109173. https://doi.org/10.1016/j.engappai.2024.109173 


- [9] Peng D, Liu Z, Wang H, Qin Y, Jia L. A novel deeper onedimensional CNN with residual learning for fault diagnosis of 


- [15] Zhang Z-F, Gao Z, Liu Y-Y, Jiang F-C, Yang Y-L, Ren Y-F et al. Computer vision based method and system for online measurement of geometric parameters of train wheel sets. Sensors. 2012;12(1):334-346. https://doi.org/10.3390/s120100334 

RAIL VEHICLES/POJAZDY SZYNOWE 1-2, 2025 

31