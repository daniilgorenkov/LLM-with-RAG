## Adaptive time series representation for out-of-round railway wheels fault diagnosis in wayside monitoring## Afonso Lourenço[a][,][*] , Carolina Ferraz[a] , Diogo Ribeiro[c] , Araliya Mosleh[b] , Pedro Montenegro[b] , Cecília Vale[b] , Andreia Meixedo[b] , Goreti Marreiros[a ]a GECAD, Polytechnic of Porto, School of Engineering, Porto, Portugal b CONSTRUCT-LESE, University of Porto, Faculty of Engineering, Porto, Portugal c CONSTRUCT-LESE, Polytechnic of Porto, School of Engineering, Porto, Portugal## **1. Introduction**The railway sector plays a vital role in transporting passengers and goods, and as such, reliability and maintainability are crucial to ensure continuous operations . With trains designed to operate for decades and maintenance costs accounting for a significant portion of the total expenditure, there is an urgent need to keep safety and quality of service at an optimal level while minimizing the operational costs. In particular, the small wheel-rail contact patch has received a lot of attention in the literature, due to its increasing hazard function and associated safety risk [2–4]. The high stick and sliding stresses in rolling contact leads to wheel out-of-roundness, typically manifested in isolated wheel flats, corrugated wheel treads, and polygonal wheels. These can lead to high-impact forces thatpose a significant risk of train derailment, generate substantial noise, and aggravate the development of track defects . Therefore, neglecting the issue of wheel out-of-roundness can have serious consequences, which is why it is imperative to address it promptly through effective maintenance and monitoring practices. To address this issue, the railway industry often implements a preventive maintenance strategy, which can be based on either tonnage or kilometers traveled . This approach involves routine inspections and maintenance activities to stop wheel abnormalities from developing into more critical problems, putting wheels among the most expensive components to maintain . However, the effectiveness of preventive maintenance relies on various operational and environmental factors such as lighting conditions, meteorological variables, and the physical and mental state of inspectors . Even with extensive experience, identifying defects such as small wheel flats remain a laborious task, and they are easily overlooked during inspections .With the Internet of Things rapidly expanding, many opportunities arise for the implementation of advanced condition monitoring systems in the railway sector. One of the most promising technologies is vibration-based systems . There are two main categories for wheel damage detection: onboard and wayside measurement methods. Onboard techniques involve installing sensors on the vehicle to monitor the condition of the track and the wheels . However, this method is rarely used due to the high costs and maintenance problems associated with installing sensors on in-use vehicles. Alternatively, wayside measurement systems are a more feasible solution to identify wheel defects, as the installation of sensors on the track allows the extraction of significant amounts of data referring to all the operating vehicles, thus enabling the methodology to monitor various vehicles with a reduced number of sensors [14–16]. Nonetheless, pinpointing the actual fault in the rail-wheel interface is a complicated process that involves contact mechanics and several modes of material deterioration. The vehicle-track dynamics and forces to support, accelerate, brake, and guide the train leads to unbounded, unlabeled, noisy, and non-stationary time series measurements. In addition, the ever-changing contact surface alteration and friction wear further complicates the process .Thus, to tackle this issue, advanced signal processing methods have been proposed that extract condensed damage-sensitive knowledge from time-series sensor data. Several contributions were proposed with traditional vibration analysis using time-domain and frequency-domain features , with the wavelet transform being the most widely used technique [19–21]. However, all these approaches revealed limitations in dealing with the non-linear effects on the suggested time-dependent characteristics. For instance, changes in train speed tend to affect the impact load, but this can vary based on the specific length of wheel flats, not following the pattern of increased impact load with higher train speeds . Some alternatives were then suggested, such as a time–frequency kurtosis to reduce surrounding noise and highlight faulty signal patterns of wheel flats  and empirical mode decomposition (EMD) to transform the signal into several intrinsic mode functions that isolate the failure signal mode from in terferences. Also, a criterion based on signal lag and envelope spectrum , symbolic data , and autoregressive models  are techniques used to extract the features. Furthermore, all the aforementioned studies have concentrated on the development of techniques for detecting wheel flats and polygonization. However, to the authors’ knowledge only a few works have achieved comprehensive and automated fault diagnosis  with the three necessary objectives: (1) detection of abnormal train behaviour; (2) isolation of specific defective wheels; (3) identification of the severity for the respective defect type . This need for inter pretability of detected faults has been confirmed by recent literature reviews on artificial intelligence for railway applications . To address this, building a physical-based model provides the opportunity to validate the full diagnosis task and interpret artificial intelligence models, since it would be cost-prohibitive to induce them in a real railway system. In the last two decades, researchers explored the intricate mechanisms of out-of-roundness formation on wheels , making it possible to induce reliable faults into a simulation . Numerical modelling allows for a deeper understanding on the prediction of anomalies that may not be feasible to reproduce in experimental measurements affected by external factors, such as environmental disturbances, measurement errors, and electromagnetic interferences.Based on this research gap, the added value of this paper lies in building an automatic and unsupervised fault diagnosis algorithm for out-of-roundness, with two failure modes: wheel flats and wheel tread polygonization. For this, the algorithm must be capable of extracting knowledge of an accelerometer and strain gauge to isolate patterns in different wheel passages. With a Hidden Markov – Model (HMM), it was possible to assess the individual condition of wheels for localized feature extraction. For time frequency analysis, the Short-time Fourier Transform (STFT) was selected for its ability to address the non-linear environmental and operational effects . Then, with Principal Feature Analysis (PFA) a minimal feature subset was used for an Isolation Forest (iForest) to diagnose the defective wheels, while uncovering the causal relations between specific inputs and specific out-of-roundness failure modes. Results were compared with other state-of-the-art anomaly detection algorithms, i.e., mahalanobis distance, support vector machines and local outlier factor. The developed strategy was validated with 3D numerical train-track dynamic interaction simulations, carried out with the in-house software Vehicle-Structure Interaction Analysis . By defining unknown variables one by one, while observing how the methodology deals with the effect of these unknown parameters in the responses, the decision support system can be deemed reliable. Ultimately, the proposed methodology aims to be generic and with successful validation has the potential to be applied to real experimental data considering different types of trains and wheel defects. The main contributions of this work are threefold:- development of a methodology capable of wheel fault diagnosis without interfering with normal operating conditions, focusing on the challenging task of fault isolation and localization;- segmentation of the time series measurements, for implicit indexing and guided extraction of localized features, easily correlated with the damage of an individual wheel;- test the effectiveness of the proposed method with respect to different types and sizes of out-of-roundness defects with high ac curacy, using enough data to confirm generalization.**Fig. 1.** Flowchart of out-roundness wheel fault diagnosis methodology.The rest of this paper is organized as follows: Section 2 describes the fault diagnosis methodology. Section 3 explains the process of simulating train-track dynamic interaction and numerical modelling, while section 4 presents and discusses the results obtained. Finally, Section 5 summarizes our main conclusions and describes ideas for future work.## **2. Fault diagnosis methodology**## 2.1. OverviewThe suggested method for detecting, localizing, and identifying out-of-roundness a monitoring system is a brand-new, allencompassing strategy that includes a four-stage process for successful fault diagnosis, depicted in Fig. 1. The method is intended to solve the challenging nature of localizing out-of-round wheels in a train passage with several wagons andsubsequently identify the severity of the defect individually. The initial stage of the approach involves segmentation using Hidden Markov Models (HMM) to capture the temporal structure of the strain gauge signal, which is frequently less impacted by out-ofroundness damage. This step is vital in enabling the extraction of several localized features from the data, conducted in the second stage. In order to handle non-linear environmental and operational influences, guided Short Time Fourier Transform (STFT) is used to retrieve both statistical and frequency domain characteristics in accelerometer data. The third stage of the approach involves deter mining a minimal subset of features for fault diagnosis using Principal Feature Analysis (PFA). Finally, a single damage indicator is created with Isolation Forest (iForest) for each group of axles to complete the fault diagnosis task, considering the differences in vi bration patterns between the train axle groups. It is worth noting that the proposed approach is designed to be practical and efficient in real-world applications, as only the selected features are extracted in online deployment of the monitoring system.## 2.2. SegmentationSegmentation can be effectively used as a front-end signal processing technique to partition vibration signals into distinct segments. These segmented portions of the data can then undergo subsequent analysis to extract dynamic features indicative of the wheel-rail dynamics. In this context, the Hidden Markov Model (HMM) was selected as it enables high computational efficiency and provides a way to comprehend the signal’s underlying structure by associating sequences of observations with distinct hidden internal states . To achieve this, the Baum-Welch algorithm is used under an iterative Expectation-Maximization approach to estimate model parameters from observed data . Additionally, the Viterbi algorithm and the Forward-Backward algorithm are used to specify start probability vectors, transition probability matrices, and model likelihoods .Employing this approach results in consistent and meaningful segments that can be indexed automatically to the corresponding wheel. Ultimately this allows for a more efficient and accurate analysis of the wheel-rail dynamics, identifying cutting points in a way that enables direct comparison of similar patterns in individual wheel passages. For hyperparameter tuning of the number of states, between 2 and 5 gaussian emissions were considered. However, between closely connected wagons, the departure of one wheel in terferes with the initial approach of the consecutive wheel’s signal. To tackle this partial confoundment of consecutive wheels with one another, a solution was devised by grouping the axles and developing two separate pipelines. The group of one axle is designed to handle individual axles, specifically the first and last wheels of a train. The group of two axles is dedicated to managing the pairs of axles located between closely connected wagons. With this segmentation technique, three main purposes were achieved:- guided short-time windowing for the STFT, making the approach less sensitive to environmental and operational variations; • localized feature extraction in both the statistical and frequency domain. This was particularly important in handling the temporal dependence of the data, which is a crucial factor in ensuring a more comprehensive understanding of the system and accurate fault detection;- implicit indexing of each wheel passage proved to be a crucial aspect in the subsequent fault isolation and localization process. This allowed for more targeted and efficient maintenance, resulting in reduced downtime and cost savings.- guided short-time windowing for the STFT, making the approach less sensitive to environmental and operational variations;- localized feature extraction in both the statistical and frequency domain. This was particularly important in handling the temporal dependence of the data, which is a crucial factor in ensuring a more comprehensive understanding of the system and accurate fault detection;- implicit indexing of each wheel passage proved to be a crucial aspect in the subsequent fault isolation and localization process. This allowed for more targeted and efficient maintenance, resulting in reduced downtime and cost savings.## 2.3. Time-frequency analysisIn damage detection systems, feature extraction is critical in converting the time series data into alternative information sensitive to damage . However, extracting useful features from raw data poses significant challenges in removing environmental and oper ational effects from the identified dynamic properties, to make it easier to detect potential damage and take preventative measures .## 2.3.1. Short-time Fourier transformTo address the presence of non-linear factors in the railway environment, the Short-time Fourier Transform (STFT) was adopted . By computing the Fourier transform for overlapping short-time windows of a segmented signal, STFT creates a power spectrum of the signal over time, providing a more accurate analysis of the magnitude spectra of each time segment. STFT has been found to yield promising results in identifying different types of faults and handling noise in various applications related to wheel condition monitoring, exhibiting comparable performance when compared to commonly used alternatives such as wavelet and Wigner-Ville transform [43–45].– In the field of time frequency representation theory, a well-known trade-off exists between accuracy in one variable and the other. When using wide time windows, the frequency resolution improves, but the time resolution suffers, making it difficult to precisely locate wheel defects. Conversely, narrow time windows offer better time resolution but distort the signal’s frequency content within that timeframe. Therefore, determining the window length requires finding a compromise that balances both time and frequency resolutions. To address this resolution trade-off and enhance fault detection, HMM were employed to define the window duration. This approach provided better time and frequency resolution for different parts of the vibration signal, enabling more precise detection offaults. The signal was split into HMM-based sequences, and overlapping adjacent segments generated windows by 50%. The resulting number of windows is twice the number of segments minus one, providing a more comprehensive and detailed analysis of the signal. The outcome after applying this segmentation was a variable sized time series, where m segments were obtained for the K scenarios of one axle and p segments for the J scenarios of two axles.## 2.3.2. Feature extractionThe segments were used to extract 21 features based on the windowing technique. Experimental studies have shown the potential of these features in enhancing vibration-based structural damage detection methods, particularly under environmental effects. . In the time domain, 14 features were extracted from each segment, including mean, max, min, power, and margin. Envelope metrics, such as peak-to-peak amplitude, root mean square, variance, standard deviation, skewness, kurtosis, crest factor, form factor, and pulse indicator, were also selected to capture the overall shape of the data. In the frequency domain, 7 features were extracted for each window, including mean, peak, sum, and envelope metrics, allowing for detecting magnitude variation over frequency. These included variance, skewness, kurtosis, and relative margin.This led to the automatic construction of two three-dimensional feature matrices, one for a single axle and the other for two axles. The dimensions of the matrix in groups of one axle K -by-21-by- m , where K is the total number of scenarios of one axle, 21 the total number of time–frequency features and m is the number of segments extracted. Simultaneously , J- by-21-by- p is the matrix for groups of two axles, where J is the total number of scenarios of two axles and p is the number of segments extracted. These matrices contained valuable information for further analysis and damage detection.## 2.4. Feature selectionIdentifying the minimum feature subset that characterizes incipient failures is crucial for effective monitoring and model inter pretation. To achieve this, the Principal Feature Analysis (PFA) algorithm was chosen due to its computational efficiency, general izability, and suitability for unsupervised settings. This filter method uses the k -means method to select a representative feature set based on the structure of a Principal Component Analysis. The goal is to obtain a principal feature subset with maximum variability in a smaller dimensional space .## 2.4.1. Principal Component analysisEnvironmental factors such as temperature and wind, and operational variables like train speed and type, can significantly in fluence vibration characteristics. Although the variables are not directly measured, their impact can be detected by analyzing changes in the observed features. To surmount this challenge, a latent variable approach of Principal Component Analysis for feature space resolution can be extremely useful . Through analysis of the matrices, containing the features extracted from the dynamic re sponses of each of the segments, PCA rotates the original coordinate system using a 21-by-21 orthonormal linear transformation matrix. After obtaining the covariance matrix of the extracted features via singular value decomposition, the general rule of cumulative variance reaching 80% is used to select the eigenvalues .## 2.4.2. k-means ClusteringTo leverage the reduced dimension space for feature selection, k -means algorithm is adopted to regroup the data into arbitrary k clusters. The idea is to find k centroids that minimize the Euclidean distance of each vector to its nearest centroid. This method requires k to be defined in advance. However, as we are using it as an auxiliary tool for feature selection, the range to be considered is not critical. Nonetheless, the global silhouette index is used to validate the quality of the resulting feature space, since it revealed a superior performance in previous studies . Then, we choose the feature vector closest to each centroid as a representative feature. To find the n most distinct features, since k -means is a non-deterministic algorithm, 10,000 runs varying k between 2 and 10 were made. It is important to note that PFA returns the minimal subset in terms of redundancy, not accounting for predictive power. The outcome is matrices K -by- n -by- m and J -by- n -by- p , where n is the number of selected features.## 2.5. Damage indexAnomaly detection involves ranking instances whose intrinsic properties deviate from normal behavior, in the form of a damage index . These methods typically use distance and density metrics as a ranking measure . However, these have difficulty in detecting both scattered anomalies, i.e., polygonization defects, and clustered anomalies, i.e., wheel flats. To deal with this masking effect, a mass-based approach is more adequate as it has no regard for the characteristics of the regions, e.g., shape and size . In this work separate anomaly detection models were built for groups of one and two axles to deal with the differences in vibration patterns captured with the segment-based features. The former corresponds to matrix of K -by- m for the first and last wheels, while the latter to the matrix J -by- p for consecutive axles of closely connected wagons.## 2.5.1. Isolation ForestConsidering the requirement of real-time monitoring and non-linear relationships represented in the vibration signal, the Isolation Forest (iForest) algorithm’s score is leveraged for identifying mass-based anomalies. This approach is preferred for its stability under hyperparameter tuning, computational efficiency, and the absence of assumptions on data distribution . The iForest algorithm operates by constructing multiple binary trees and randomly selecting a feature and split value within a specified range until eachterminal leaf contains only one instance or instance with the same value . The number of splits obtained is used to calculate a score that indicates the individual instances’ susceptibility to be isolated. Despite its effectiveness, iForest is predisposed to bias towards groups of correlated variables due to the computation of random splits, which was mitigated with the previous step of feature selection . As anomalies represent the events of interest, the iForest ranking score was used for simultaneous fault detection and severity identification while the representative data structure ensured the ability to isolate the location of defects. To inspect the tradeoff between false positives and false negatives, two parameters were considered: the subsampling size ψ from 0.  to 1 and the number of trees to build t from 50 to 500. Finally, leveraging on the simulated dataset, the isolation paths that led to the decision that a particular data point is an anomaly were analysed. This provides local interpretability by helping uncover the causal relations between specific regions of the feature space and specific fault types, ultimately helping users trust the iForest model.## 2.5.2. Benchmark modelsTo assess the performance of the suggested damage index, its performance was compared to other anomaly detection techniques that have been extensively used in the literature. Three benchmark models were used: the Mahalanobis distance (MD), Support Vector Machine (SVM), and Local Outlier Factor (LOF).LOF works by examining the local density of each instance in the dataset and comparing it to the density of its neighboring in stances . Instances with low density, which are far from other instances, have a higher likelihood of being outliers. However, LOF may be prone to errors in regions with varying densities and skewed distributions, leading to inaccurate anomaly detection. MD is another statistical technique that is commonly used in damage identification studies . It calculates the distance between points in a feature space, considering the correlations between the variables and the scale of each variable . SVM learns a decision boundary that separates normal observations from anomalous observations in high-dimensional feature space . Once the hyperplane is learned, new observations can be classified as normal or anomalous based on their distance to the hyperplane. Despite being robust to imbalanced datasets, this technology has difficulties with complex and nonlinear data distributions.## **3. Modeling and simulation**## 3.1. Train-track dynamic interaction**Fig. 4.** Acceleration time series for different wheel flat lengths.## 3.2. Numerical modellingThe wheel out-of-roundness detection system includes an accelerometer and strain gauge installed along the stretch of the track. To test and validate the methodology presented in this study, a wide range of 3D simulations based on the train-track interaction model were performed. The virtual wayside monitoring system includes measurements evaluated for 24 different locations mounted on the rail between two sleepers. Fig.  exemplifies 4 sensors installed along the stretch of the track in midspan location.A virtual simulation of baseline and damaged wheel scenarios was accomplished to test and validate the automatic out-ofroundness diagnosis presented in this study. After successful validation, this method has the potential to be applied to real experi mental data considering different types of trains with several wheel defect conditions. In real conditions, the wheels are not entirely smooth and have imperfections, i.e., flats and polygonization. Despite their small size, these out-of-roundness irregularities can cause extreme variations in the wheel–rail contact forces, producing vibrations on the train and track components. As presented in Fig. 2, three wheels were considered as defective: the first and last on the right side, and the sixth on the left side.For wheel flats, two intervals of flat lengths ( Lw ) were considered, nominated as L1 and L2. The uniform distributions U (25, 50) mm, and U (50,100) mm define the lower and upper limits of the wheel flat length for each interval L1 and L2, respectively. The wheel flat depth ( Dw ) is calculated based on the following equation :in which Rw is the radius of the wheel. The vertical profile deviation of the wheel flat is defined as:where H represents the Heaviside function and xw is the coordinate aligned with the track longitudinal direction. Fig.  illustrates the effect of different wheel flat severities.For wheel polygonization, a periodic radial tread irregularity around the wheel circumference was considered by varying wave lengths ( λ ) in the function of the harmonic order (θ) and wheel radius.The selected wheel profiles were characterized by the wavelengths in the first 20 harmonics, with the 6th to 8th harmonic orders being dominant and different irregularity wheel profiles generated based on the sum of sine functions ( H = 20) as follows:**Fig. 5.** Wheel irregularity amplitude spectra ( Lw ) and harmonic order (θ).**----- Start of picture text -----**
 H 2 π
w ( xw ) = [03∑ B 8]=1 A θ sin ( λ [x] [w] [ +] [ φ] [θ] )
**----- End of picture text -----**where A θ is the amplitude of the sine function for each wavelength, which is calculated by the function:with wref = 1 μm . The wheel irregularity level ( Lw ) values were selected based on the irregularity spectrum in Fig. 5, produced with measurement values of four wheels with polygonal damage . Considering phase angles to the sine functions that are uniformly and randomly distributed between 0 and 2π, several wheel irregularity profiles were generated with Equation (4) to obtain different damage severities between 0.  mm and 1.  mm.In real conditions, the rails also present small imperfections that can significantly affect the wheel-rail contact force values. In this context, 10 irregularities profiles, shown in Fig. 6, were generated for wavelengths between 1 m and 30 m, which covers the D1 wavelength interval defined by the EN 13848–2 standard , with a sampling discretisation of 1 mm.− The amplitude of the irregularity profile was varied between 2 mm and 2 mm, for a total simulation length of 100 m. These were based on the real track irregularities of the Northern Line of the Portuguese Railway Network, measured with a track inspection vehicle EM120 every six months. It is important to note that the wavelengths used to generate these track irregularities are significantly longer than the wheel flat and polygonization. Thus, the exited frequencies due to the track are much lower than those of a defective wheel. More details about the generation of unevenness profiles can be found elsewhere .By reproducing the responses of the rail considering several speeds, wheel profiles and rail irregularities, different time-series samples were simulated to capture a range of operating conditions . The dynamic analyses were carried out for one passing vehicle. Table 1 summarizes the 23520-wheel scenario, divided into groups of one axle ( J = 7440) and two axles ( K = 16080). Within these groups, further subdivisions were made according to baseline and damaged conditions. The first encompasses the passage of baseline vehicles between 60 and 100 km/h in 10 unevenness profiles, measured by 24 different sets of sensors (accelerometer and strain gauge). The second includes the measurement of vehicles with defective wheels circulating at 80 km/h, for a single unevenness profile and 24 different sets of sensors. To obtain a more reliable reproduction of the rail response, an artificial noise was generated**----- Start of picture text -----**
 Baseline scenarios Damaged scenarios
Perfect wheel Polygonized wheel Flat wheel
Vehicle 5 freight wagons of the Laagrss type
Irregularity profiles 10 1 1
Speeds 60 – 100 km/h 80 km/h 80 km/h
Noise ratio 5 % 5 % 5%
Location of defect – 1st wheel right 1st wheel right
6th wheel left
10th wheel right
Amplitude of defect – 0.  – 1.  mm 25 – 50 mm
50 – 100 mm
Total passages of 1 axle 6240 720 480
Total passages of 2 axles 15,360 0 720
**----- End of picture text -----****Fig. 7.** Segmented strain gauge for healthy wheels with different gaussian emissions.based on 5% of the maximum response of the signal and added to all the original signals. Additionally, all the time series are filtered based on a low-pass Chebyshev type II digital filter considering a cut-off frequency of 500 Hz.## **4. Fault diagnosis**## 4.1. SegmentationTo offer a concise discussion of the results, these are illustrated for an exemplary train passage while examining the overall per formance of each step. Firstly, the HMM was fitted to the shape of the gauge signal considering between 2 and 5 states of gaussian emissions, as depicted in Fig. 7. All states overcame the partial confoundment of consecutive wheels with one another due to the closely connected wagons. However, only with 2 and 3 hidden states there was a consistent segmentation for all wheel passages. The other segmentations, despite adapting well to the shape of the monitoring signal, weren’t reliable under a high noise ratio and defective conditions.Consequently, for automatic segmentation, the HMM with 3 states was selected as it allowed to remove the portion of the wheel signal in between wheel passages. Furthermore, the obtained indexing was granular enough to capture the three stages of a wheel passage: the initial approach towards the sensor, the detection phase where the wheel is on top of the sensor and the departure, as it**Fig. 9.** Distribution of segment lengths in logarithmic scale for groups of one axle.moves away from the sensor. This granularity proved useful in extracting the impact of an out-of-round wheel on the corresponding accelerometer signal, as shown in Fig. 8.As illustrated in Fig. 8, the shape of accelerometer signal is disrupted upon a damaged scenario, opposed to the strain gauge. Thus, leveraging on the unaltered shape of the strain gauge signal upon a damaged wheel, automatic segmentation could be performed for the attainment of meaningful subsequences in the accelerometer signal of each passage. For groups of one and two axles, 3 and 5 segments were respectively engineered as shown in Fig. 8. These were then used to generate the window duration in STFT and for localized feature extraction in in the accelerometer signal, which is more sensitive to damage. To study the robustness of the seg mentation, Fig.  and Fig.  provide the distribution of segment lengths in logarithmic scale for the different scenarios in groups of one and two axles.**Fig. 10.** Distribution of segment lengths in logarithmic scale for groups of two axles.It is important to note the color bar is in logarithmic scale. In Fig. 9, for the three stages of the wheel passage in groups of one axle, there is a stable segmentation between within ranges 1215–1371, 606–761 and 1063–1218 tenths of a millisecond, corresponding to approximately 10% deviation. Within these ranges, the interaction between the length of segments and the damaged scenarios is merely indicative of the imbalanced dataset. Apart from a few outliers, only in the detection phase with the wheel on top of the accelerometer, considerable larger segments were extracted for a length of 910 to 914 tenths of a millisecond. Regarding the groups of two axles in Fig. 10, both the movement of the first wheel towards and of the second wheel away from the accelerometer exhibit the same pattern of the groups of one axle. However, the partial confoundment of the consecutive wheels results in smaller segments from 453 to 610 tenths of a millisecond, when the wheel is on top of the accelerometer. As for segment corresponding to the overlap of the wheel’s movement, the range is 302 to 457 tenths of a millisecond.## 4.2. Time-frequency analysisAs shown in the figure, certain features extracted from the data exhibit sensitivity to damage, with higher magnitudes and fluc tuations compared to the baseline scenarios. For instance, Fig.  demonstrates that the amplitude differences between healthy and damaged scenarios are more pronounced for certain features, e.g., peak, which remains relatively stable results. Conversely, it also presents features, e.g., skewness of total band power, whose amplitude variation due to out-of-round wheels is similar to that resulting from environmental and operational effects in the baseline scenarios. These findings suggest that each feature captures unique aspects of the damage condition, and that a comprehensive approach based on selected features is necessary to fully capture the diagnostic information. Environmental and operational effects may obscure the damage signal and make it challenging to differentiate between baseline and damaged scenarios.## 4.3. Principal feature analysisTo identify the most informative and discriminative features that can best differentiate between different conditions or states, PFA was applied to the matrices of both groups of axle 7440-by-21-by-3 and 16080-by-21-by-5. For the first stage of Principal Component Analysis, as explained previously, a cumulative variance of 80% to streamline the analysis. In the second stage, 10,000 runs of k -means clustering were performed, varying k between 2 and 10, to overcome the non-deterministic nature of the algorithm. This step ensured**Fig. 11.** Individual feature values as anticipated damage indicators.**----- Start of picture text -----**
 Number of axles Time-domain Frequency domain
Peak Root main square Skewness of total band power Sum of total band power
1 5952 1843 4889 4700
2 4577 2916 3227 4252
**----- End of picture text -----**that the resulting clusters were stable and not dependent on the initial random seed value. The features that were most selected as representative of a cluster are presented in Table 2. The most selected features were identified the peak and root main square in the time domain, and the sum and skewness of total band power in the frequency domain. To gain a deeper understanding of this selection process, Fig.  illustrates the correlation analysis of the extracted features in each stage of a wheel passage, with features f1 corresponding to the initial approach towards the sensor, f2 to the detection phase where the wheel is on top of the sensor and f3 to the departure, as the wheel moves away from the sensor.The results illustrate how these features represent clusters of highly correlated variables within each segment, except for the skewness of the total band power feature. In fact, as described earlier, this statistic was found to be irrelevant to the diagnose of defective wheels and thus removed from the analysis. The presence of the remaining features suggested the existence of underlying physical phenomena. Both the peak and root main square in the time domain were successful discriminators of the higher force exerted on the track by a flat wheel, while for other types of wheel tread defects, i.e., polygonization, there was a clear difference in frequency bands of the measurement, which was captured by the sum of total band power. Thus, these 3 features were selected for the anomaly**Samples**|**F1-score**| |---|---| ||**1 axle**
**2 axles**| |150
0.01
300
0.01
**450**
**0.01**
150
0.21
300
0.21
450
0.21
150
0.41
300
0.41
450
0.41
**150**
**0.61**
300
0.61
450
0.61
150
0.81
300
0.81
450
0.81|0.9975
0.8306
0.9925
0.8389
**1**
0.8389
0.9442
0.8667
0.9383
0.8653
0.9450
0.8708
0.9475
0.8722
0.9425
0.8708
0.9392
0.8764
0.9383
**0.8833**
0.9342
0.8792
0.9300
0.8819
0.9375
0.8750
0.9342
0.8736
0.9308
0.8778|**2 axles**| |100
200
300
400
**500**|0.0883
0.4139
0.0850
0.6417
0.1925
0.7722
0.3308
0.8139
**0.4017**
**0.8264**|**2 axles**| |**0.1**
**0.3**
0.5
0.7
0.9|0.4356
**0.1793**
**0.5830**
0.1372
0.4911
0.1535
0.5563
0.1338
0.5619
0.1320|## 4.4. Damage indexIn this study, two separate anomaly detection rankings were built for each matrix of 7440-by-3-by-3 and 16080-by-3-by-5. Building separate models for the two groups helped to deal with the differences in vibration patterns caused by the consecutive wheels in groups of two axles. Regarding hyperparameter tuning of the iForest, the findings of the analysis support the original paper’s proposition that a broad range of values for the parameters of number of trees and samples required to split have little impact on detecting instances deemed to be anomalies, as shown in Table 3. In this research study, the parameters were set as 450 and 0.01, respectively, based on the F1-score of overall detection. For this calculation, the contamination percentage, i.e., the threshold to consider instances as anomalies, was defined with the actual value of 1200/7440 for the group of one axle and 720/16080 for two axles.In addition, to allow for a fair performance benchmark of the iForest, the other algorithms were also submitted to hyperparameter tuning. In LOF, it was studied a range between 100 and 500 of nearest neighbors to consider when calculating the local density of each data point, as depicted in Table 4. A smaller number of neighbors makes the algorithm more sensitive to outliers, as it may classify points with a lower density as outliers if their nearest neighbors also have a low density. While for SVM, the gamma parameter that determines the influence of each training example on the model’s decision boundary was varied between 0.  and 0.9, as shown in Table 5. A smaller gamma value will result in a smoother decision boundary, while a larger gamma value will result in a more complex decision boundary that is more likely to overfit the training data.The F1-score offers provides an indication of the overall success of the iForest in both fault detection and isolation, due to the## **Table 7**individual treatment of groups of one or two axles. Furthermore, for the selected hyperparameters, it was studied how the contam ination percentage used as threshold affected the area under the receiver operating characteristic cure (AUC-ROC) . In practice, this threshold might be limited by various factors, such as the number of defective wheels or the availability of maintenance department resources, i.e., stock of spare parts and workforce. Fig.  shows the AUC-ROC obtained for the various anomaly detection models.The AUC-ROC and its corresponding score provide insights into the success of the fault identification task in terms of severity. A higher AUC indicates that the system is better at distinguishing between faulty and non-faulty instances. It implies that the ranking obtained from the anomaly scores is effective in capturing the severity of faults, as the system can differentiate between them with a higher degree of accuracy. As shown, MD and LOF were successful in fault identification for groups of one and two axles, respectively. However, only iForest presented a stable performance, with scores of 0.  in both groups. To provide a more detailed analysis of the success of the full fault diagnosis task with the iForest algorithm, Table 6 depicts the confusion matrix with contamination equal to the proportion of defective wheels. Out of 7440 wheels, only 22 (0.2%) polygonization treads of low harmonics were confounded with – undamaged scenarios. As for wheels with flats of 50 100 mm, these were identified as most anomalous with perfect precision. Furthermore, the progression of false positives across only consecutive classes suggests that the model is successfully ranking the**Fig. 14.** Damage indicator based on various anomaly detection algorithms.Regarding groups of two axles, results were also promising in terms of the most severe flats, as illustrated in Table 7. Only 105 out of 240 wheels with small flat depths were confounded as non-defective wheels. Notably, these wheels exhibited a flat length below the replacement threshold recommended by the General Contract for the Use of Waggons . For instance, a wheelset with a diameter larger than 840 mm should only be replaced if the wheel flat length exceeds 60 mm. Therefore, the proposed strategy not onlydemonstrated complete accuracy in detecting faults, but also had the potential to predict the emergence of flats before they reach a critical state. In practice, these findings suggest that when tackling the unsupervised context of the real-world application, if the maintenance technician follows the predicted rank and starts to be consistently advised to replace wheels then he can be confident that all wheels are in good conditions.Finally, Fig.  summarizes the damage indicator for all 23520-wheel passages, with benchmark models being outperformed by the iForest. The scenarios were separated by a black line into two groups, as in Fig. 10.## **5. Conclusions**In this paper, an automatic fault diagnosis algorithm for wheel out-of-roundness was developed, focusing on two failure modes: wheel flats and wheel tread polygonization. The proposed methodology consisted in applying a HMM to guide signal preprocessing with variable STFT to ultimately extract localized features in the statistical and frequency domain, overcoming the limitations of addressing non-linear environmental and operational effects. Using PFA for a subset of the attained time series representation, it was possible to select damage-sensitive features with minimal redundancy. With the selected features a single severity indicator was computed based on the iForest anomaly score. This completed the fault diagnosis with (1) detection of aberrant train behavior; (2) isolation of specific defective wheels; (3) identification of the severity. The main achievements, including contributions from this study, can be summarized as follow:- A novel method of signal segmentation, leveraging the sensitivity of each type of sensor. The stable temporal structure of the strain gauge signal was used to segment both signals, while feature extraction was focused on the most damage-sensitive accelerometer, less impacted by non-linear operational and environmental factors;- Fault localization method proposed in this study offers a wheel-based approach with implicit indexing and axle count, thereby providing infrastructure managers and maintenance personnel with more comprehensive and valuable information;- The methodology doesn’t require the installment of a series of sensors on the rail, reducing the cost of installation and maintenance. By only using one accelerometer and strain gauge data quality wasn’t compromised;- The final anomaly detection stage not only provided a comprehensive context to the success of the fault localization method in distinguishing a healthy wheel from defective ones, but also provided a damage indicator for severity identification, regardless of different wheel profiles, track irregularities, train speeds, position of the sensors and artificial noise, associated to other envi ronmental and operational variations.Such results demonstrate the high potential of this innovative application of artificial intelligence in the railway wheels mainte nance. As this method was validated with physical-based modelling, the next efforts should lie in ensuring there are not too many unfulfilled assumptions and rough approximations. Thus, future work includes a field trial to further evaluate the proposed meth odology based on on-site measurements. Furthermore, the robustness and efficiency of the methodology will be assessed under distinct track environments, particularly in the presence of bridges, tunnels and other under passing structures, will be evaluated.## **Data availability**## **Acknowledgements**## **References**-  R. Lagneb¨ack, “Evaluation of wayside condition monitoring technologies for condition-based maintenance of railway vehicles”.-  Y. Lu, I. Cohen, X. S. Zhou, and Q. Tian, “Feature selection using principal feature analysis,” in Proceedings of the 15th ACM international conference on Multimedia , 2007, pp. 301–304.-  I. Jolliffe, “Principal component analysis,” Encyclopedia of statistics in behavioral science , 2005.-  L. Puggini, S. McLoone, An enhanced variable selection and Isolation Forest based methodology for anomaly detection with OES data, Eng. Appl. Artif. Intel.  (2018) 126–135.-  M. M. Breunig, H.-P. Kriegel, R. T. Ng, and J. Sander, “LOF: identifying density-based local outliers,” in Proceedings of the 2000 ACM SIGMOD international conference on Management of data , 2000, pp. 93–104.-  H. Hertz, “Ueber die Berührung fester elastischer Korper.,¨ ” 1882.-  J.J. Kalker, Book of Tables for the Herzian Creep-force Law, Delft University of Technology, Faculty of Technical Mathematics and Informatics, 1996.-  B. Standard, Railway applications/Track-Track geometry quality, BS EN (2003) 13841–13848.-  GCU, General contract of use for wagons – GCU , Edition dated. 2018.