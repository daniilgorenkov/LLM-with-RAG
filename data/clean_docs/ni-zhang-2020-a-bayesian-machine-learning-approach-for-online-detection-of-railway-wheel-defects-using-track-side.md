# A Bayesian machine learning approach for online detection of railway wheel defects using track-side monitoring## Yi-Qing Ni and Qiu-Hu Zhang## AbstractWheel condition assessment is of great significance to ensure the operation safety of trains and metro systems. This study is intended to develop a Bayesian probabilistic method for online and quantitative assessment of railway wheel conditions using track-side strain-monitoring data. The proposed method is a fully data-driven, nonparametric approach without the need of a physical model. To enable defect identification using only response measurement, the measured dynamic strain responses of rail tracks during the passage of trains are processed to elicit the normalized cumulative distribution function values representative of the effect of individual wheels, which in conjunction with the frequency points are used to formulate a probabilistic reference model in terms of sparse Bayesian learning. Through cleverly realizing sparsity by introducing hyper-parameters and their priors, the sparse Bayesian learning makes the resulting model to exempt from overfitting and generalize well on unseen data. Only the monitoring data in healthy state are needed in formulating the reference model. A novel Bayesian null hypothesis significance testing in terms of scale-invariant intrinsic Bayes factor, which does not suffer from the Jeffreys–Lindley paradox, is then pursued in the presence of new monitoring data collected from possibly defective wheel(s) to detect wheel defects and quantitatively assess wheel condition. The proposed method in fully Bayesian inference framework is verified by utilizing the real-world monitoring data acquired by a distributed fiber Bragg grating–based track-side monitoring system and comparing with the offline inspection results.## IntroductionPassenger safety is the highest priority in mass transportation. This is especially true in modern high-speed rails in view of their mass transportation volume and fast speed. If a high-speed train runs in failure, it will result in a disastrous loss of mass lives and rail infrastructure. The current rail operation control systems do not have the functions of online detection of structural health and real-time response to potential structural failure, since in the current practice structural faults or damage are detected offline in depots or maintenance yards at scheduled time intervals. However, structural faults may occur during in-service operation; this issue is especially important for the high-speed trains that are in a high frequency of services. In this regard, development of effective online structural fault diagnosis methods is a core focus for preventing catastrophic failure as well as prolonging the service life of high-speed rails.Wheel condition assessment is of great importance to ensure railway safety and to reduce the maintenance cost of railway infrastructure. Wheel defects because of wheel out-of-roundness, such as wheel flats, wheel shells, and wheel polygonization, can induce damage to both train and rail track, trimming down safety and ride comfort of in-service trains and increasing operation and maintenance costs for railway system.[1–3] EarlyHong Kong Branch of Chinese National Engineering Research Center on Rail Transit Electrification and Automation, Department of Civil and Environmental Engineering, The Hong Kong Polytechnic University, Kowloon, Hong Kong## Feature extraction through track-side monitoring## Track-side monitoring systemAs illustrated in Figure 1, the FBG-based track-side monitoring system for this study consists of two arrays of FBG strain sensors deployed on two parallel tracks of a rail segment, two optical cables, a high-speedoptical interrogator, and a desktop or notebook computer. To facilitate the detection of minor wheel defects, the sensors are densely deployed along rail length but the instrumentation needs just to cover a range of rail slightly longer than the wheel perimeter. The FBG sensors are connected through optical cables to a high-speed optical interrogator which is controlled by a computer for data acquisition and processing. Both the interrogator and the computer can be located far away from the instrumented rail to facilitate remote monitoring.Figure 2 shows the deployment of the track-side monitoring system on an in-service rail. In this implementation, each sensor array comprises 21 FBG gauges evenly spaced at 0.  m intervals on rail foot of each single track, and the total instrumentation range reaches 3.  m to enable the sensing of rolling action of the whole circumference of the wheel tread (the diameter of wheel is 0.  m). Both the optical interrogator and the computer are operated in an auxiliary office which is about 120 m away from the monitoring area. The FBG sensors have been calibrated in laboratory before their installation to obtain strain sensitivity and temperature sensitivity, but in general the temperature compensation is not necessary as the time for online monitoring of the passage of a whole train just lasts for a few seconds, during which the environmental temperature does not change dramatically. The wheel-rail rolling friction may cause heating and cooling effects on the top surface of the rail, such that, the rail temperature varies to some extent, but such effects mainly influence the area of rail head and are less significant in rail foot. When both FBG strain gauges and temperature sensors are deployed, it is easy to compensate the effect of varying temperature by subtracting fromthe measured strain a thermal-induced ingredient which is equal to a constant coefficient times the difference between the measured instant temperature and the recorded temperature at the installation of the sensor.Figure 3 illustrates the time history of longitudinal (bending) strain at rail foot monitored by the FBG sensor SEN-D2 (refer to Figure 2) when a typical eight-car passenger train passes through the instrumented rail at a nominal speed of 10 km/h. The sampling frequency fs is set to be 5 kHz to ensure that the effect of minor wheel tread defect can be sensed. It is observed that the rail bending strain in the longitudinal direction variesbetween –100 and 150 me, wherein the 32 peaks concur with the 32 wheels acting on each track. Figure 4 provides the corresponding FAS in a logarithmic scale and it is seen that the strain response is dominated by lowfrequency components lower than 10
Hz when the train speed is 10 km/h. Although the FBG strain measurement depends on both loading of the train and running speed, the measured dynamic strains of rail bending can be classified into two parts: the low-frequency components and the high-frequency components separated by a cut-off frequency fc. The low-frequency components are found to be primarily controlled by axle loads and wheel bases and thus they are often used for the dynamic weighing, axle counting, and identification of trains, while the high-frequency components are mainly caused by wheel and rail surface roughness and measurement noises, and thus they are often used for wheel condition assessment. As specified later, the cut-off frequency depends only on the train speed. Thus, the classification of low-frequency components and high-frequency components is a relative concept, depending on the train speed.## Data pre-processingTo obtain the information relevant to wheel quality, Filograno et al. proposed an empirical formula to extract the wheel-sensitive response ingredients from rail strain-monitoring data, which iswhere fc is the lower cut-off frequency, v is the train speed, and k is a proportional coefficient. The proportional coefficient k is set to be 1.  Hz h/km after numerous experiments in line of different train running speeds. The response components in the frequency range higher than fc are termed as detrended data, which can be extracted from raw measurement data using an ideal high-pass filter with a cut-off frequency fc depending on train speed. The remaining part is theresponse components lower than fc, termed as trend. Figure 5(a) and (b) shows the trend and the detrended data, respectively, with a cut-off frequency of fc = 10
Hz. By segmenting the strain response time history into datasets surrounding its peak values, we obtain 32 data segments (datasets), each lasting for around 0.  s and consisting of about 1500 data points, in line with the effects of the 32 wheels. Figure 6 shows the 32 data segments (datasets) of the detrended strain response, and Figure 7 depicts the FASs of the 32 detrended data segments (datasets). Typically, an upper frequency limit fu can be adopted to eliminate the frequency-domain response components that are mainly caused by random noises. The upper limit frequency fu is the upper bound of the wheel defect–induced effect on the variation of rail bending strain in the frequency domain. It depends on the train speed and the possible maximum wheel defect. However, it is extremely difficult to explicitly determine such a relationship, partially because there is a lack of samples of the possible maximum wheel defect for field test but mainly because the wheel defect-induced impact on the rail varies nonlinearly with the train speed. In this case study, the average train speed in test is v = 10 km/h and the targeted maximum wheel defect length is Lmax = 150 mm. The upper limit frequency fu is empirically set to be 300
Weight number Weight distribution Associated kernel function: kx1k2 23402    kx9k2 23402    kx69k2 23402    kx88k2 23402 SBL: sparse Bayesian learning; BGL: Bayesian generalized linear; RMSR: root mean square residual; MSLL: mean standardized log loss.(basis functions) in the probabilistic model when g = 40, justifying a sparse representation of the built model. Table 1 shows the four relevance vectors including the distributions of active (non-zero) weights and the associated kernel functions, where the frequency band of interest xf = ½10
Hz; 300
Hz has been scaled to x = ½1; 88 using a linear transform x = 3xf =10  2 to facilitate computational accuracy and efficiency.To validate the benefit of the SBL framework, a comparative study is conducted using the non-sparse Bayesian generalized linear (BGL) model to learn the same training data. Table 2 provides a comparison between the SBL and the BGL models in terms of three performance indices. It is seen that while the learning performance in terms of RMSR and MSLL is comparable between the SBL and the BGL models, the SBL model utilizes dramatically fewer basis functions (much lower sparsity ratio), giving rise to a much simpler probabilistic model with stronger prediction ability.In this study, the SBL model is formulated using the data collected under the nominal running speed of 10 km/h. This is due to the fact that the track-side monitoring system is often installed at a location immediately before trains arrive at a railway station or terminal, for the ease of operation, management, and maintenance. As a result, it allows both low-speed trains and high-speed trains to pass the monitoring area at a fixed speed. Certainly, the SBL model can be adaptive to a wide range of running speeds by incorporating an extra variable (train speed) in the basis functions in equation (25) if enough data covering different train speeds are available.The formulated model is deemed to be robust to loading conditions as the loading conditions, such as fully loaded and non-loaded trains, do not significantly influence the wheel defect-incurred impact on the railway track, which has been validated by both numerical modeling and field test. Environmental conditions, such as wet track, ice, debris, and extremely temperature, may affect the pattern of wheel–rail interaction. To ensure the reliability of defect detection results by the proposed method, it is preferable to collect the monitoring data in the testing phase under the similar environmental conditions as to obtain the training data.The model does not evolve with time because it is formulated to represent the initial defect-free state of railway wheels. If new monitoring data collected later are confirmed from healthy state as well, the model can be refined using the newly collected data as explained in the following section. In principle, the model does not need to be updated over time. Instead, the model can be utilized to investigate the deterioration of wheel condition over time.## Bayesian hypothesis testing for wheel defect detectionA variety of diagnostic criteria are available for damage or fault identification and quantification. In recognizing the shortcomings of the commonly used distancebased diagnostic methods, statistical hypothesis tests have gained growing interest in SHM applications. For example, Bayesian point null hypothesis testing (BPNHT) has been attempted for damage or fault identification and quantification in terms of Bayes factor. It is more robust than the distance-based diagnostic methods in that its resulting risk is averaged over the priors for unknown parameters in the hypotheses. However, the BPNHT is sensitive to the priors of the unknown parameters, giving rise to the so-called Jeffreys–Lindley paradox. In this study, we introduce a novel damage diagnostic logic in terms of BNHST and IBF, which does not suffer from the Jeffreys–Lindley paradox and the effect of sample size (data scale).## BNHSTIn the previous section, a probabilistic model has been formulated by SBL using monitoring data in the state of healthy wheels. This model characterizes the stochastic CDFs in healthy state. Thus, a null hypothesis H0 can be defined for healthy wheel using the built probabilistic model. Because of the lack of monitoring data from defective wheels in the model training phase, we are unable to elicit an alternative hypothesis representative of defective wheels by using the training data.Instead, the alternative hypothesis H1 for defective wheel is made here by shifting the expectations m3 with small values of h. Thus, referring to equation (22), the two hypotheses are given bywhere yu = ½yu, 1, . . . , yu, S[T] is the new CDFs from wheels (healthy or defective) to be assessed, and m3 and S3 are the predicted expectations and the covariance as given in equations (23) and (24), respectively. The same covariance matrix is presumed in equations (29) and (30) for the computational efficiency. More importantly, it enables us to focus on the identification of the systematic change in defect-sensitive features (the means of the stochastic CDFs) caused by wheel defects. h is related to the false-positive diagnostic risk, denoted as q, which is referred to as the probability of healthy wheels being falsely diagnosed as defective. There is a one-to-one relationship between h and q, given bywhere F is the cumulative distribution function of the standard normal random variable, and 1S is a unit column vector of size S. The Bayes factor is defined as the ratio of the likelihood probabilities of the two hypotheses, given bywhere e0 = yu  m3 and e1 = yu  (m3 + h). Since BF01 is always non-negative, it can be converted to the logarithmic scale for convenience of comparison among a large range of values. It is also useful to consider twice the natural logarithm of the Bayes factor that is on the same scale as the familiar deviance and likelihood ratio test statistics, given byKass and Raftery suggested interpreting 2 ln (BF01) between 0 and 2 as weak evidence in favor of H0, between 2 and 6 as positive evidence, between 6 and 10 as strong evidence, and 2 ln (BF01).  as very strong evidence. Negative Bayes factor of the same magnitude is said to favor the alternative hypothesis H1 by the same amount. However, the Bayes factor defined earlier relies heavily on sample size such that different Bayes factor thresholds should be used when the sample size is highly different. To overcome this drawback, a novel Bayes factor, termed as intrinsic Bayes factor,is proposed in this study to eliminate the effect of sample size (data scale), which is defined as followswhere S is the size of yu. Twice the natural logarithm of IBF01 yieldsAs identical Gaussian kernels are used in the model trained by SBL, the predicted uncertainties can be approximated by S3’s MP[I][S][.][ Thus, the][ IBF][ and its] twice the natural logarithm reduce toAccordingly, the false-positive diagnostic risk q is approximately given byWhen new monitoring data from potentially defective wheel(s) are made available, the predicted expectations m3 and covariance S3 can be obtained from the built reference model. Then, the IBF01 or its twice the natural logarithm is calculated to infer the existence of defective wheel(s) and to assess the degree of wheel defect(s). Using the foregoing classification criterion on discrimination strength (more detailed classification intervals are available in Kass and Raftery ) to quantitatively assess the extent of defect is relatively subjective before physical calibration.If the new monitoring data are confirmed from healthy state, the newly collected data can be used to update or refine the current SBL model by taking the joint posterior distribution P(w, a, s jy) of the unknown parameters in the current model as a databased prior for the updated model. The model accuracy will be enhanced since the model posterior uncertainty S3 in equation (24) can be reduced by increasing the training data. As mentioned before, the formulation of the reference model does not use monitoring data in defective states. However, when monitoring data in line with confirmed defects are available, the classification intervals can be calibrated and pertinently refined to provide more precise mapping between the range of IBF and the extent of wheel defect.In comparison with the new defect-sensitive features characterized by the SBL model, the raw defectsensitive features cannot be directly adopted to perform Bayesian hypothesis significance testing in the presence of new monitoring data because their uncertainties are not quantified. Moreover, the raw and the new features have different feature inputs and thus they are not directly comparable.## Diagnostic results of wheel defects using a single sensorA blind test was later conducted by replacing some healthy wheels by defective wheels and running the train equipped with defective wheels on the rail instrumented with the track-side monitoring system. It provides in-situ monitoring data to verify the proposed wheel defect detection method. Moreover, after the blind test, the suspected defective wheels have been delivered to a workshop for offline wheel radius deviation measurement. As such, a comparison between the online diagnostic results by the proposed method and the offline inspection results can be made. It is worth noting that the monitoring data collected by a single sensor might be unable to capture the defect-relevant information in case the minor defective tread (e.g. a small flat) did not roll over the rail section deployed with the sensor; it would result in a false negative if using only the data from the single sensor. When using the monitoring data from all the deployed sensors, more reliable defect detection results would be obtained because the effect of minor defective tread must be sensed by at least one sensor if the sensors are densely deployed along a rail segment longer than the wheel perimeter. In the following section, both the wheel defect detection results using the monitoring data from a single sensor (SEN-D2) and from all the sensors are presented.In the implementation of the proposed method, the shift parameters are set to be h = 5sMP31S at the price of the diagnostic risk of 1.24% that healthy wheels are falsely diagnosed as defective, where 1S is a unit column vector of size S. The choice of h reflects the understanding of professionals regarding the presumed discrepancy in the features of wheels with and without defect. Its choice is essentially a balance between the false-positive and false-negative error rates. If the values of h are smaller, a higher rate of false alarm of wheel defect occurs, while larger values of h correspond to a higher rate of missing alarm. For different application domains, one may use customized values of h, according to the total loss caused by the two types of errors. The obtained IBFs for assessing the condition of all right wheels when using the monitoring data fromthe sensor SEN-D2 deployed on the right railway track are shown in Figure 13. It is observed that the IBF for the 24th right wheel is less than –10, which advocates very strongly that it is heavily defective. The IBF for the 27th right wheel is between –10 and –6, providing evidence that it is moderately defective. By contrast, the IBFs for other right wheels are all positive and therefore, these wheels are diagnosed as undefective.## Diagnostic results of wheel defects by integrating all sensorsThe wheel defect detection is then pursued using the monitoring data from all sensors deployed on one side of the rail. As we are interested in finding defective wheels, the smallest IBF is used in the assessment, which is given bywhere NS is the number of sensors deployed on each side of the rail. For the track-side monitoring system described in section ‘‘Feature Extraction through Track-side Monitoring,’’NS = 21.Figure 14 provides the diagnostic results on the condition of the right wheels using the monitoring data from all 21 sensors deployed on the right rail track. It can be seen that the IBFs associated with the 1st, 6th, 24th, 27th, and 31st right wheels are negative, suggesting that the five wheels are potentially defective with different degrees. The 24th wheel is most heavily defective, while the 31st wheel is most weakly defective. With IBFs being positive, the other right wheels are diagnosed as healthy. By comparing Figure 14 with Figure 13, it is found that using only the monitoring data from the sensor SEN-D2 fails to identify the defects on theFigure 15 illustrates the diagnostic results on the condition of the left wheels when using the monitoring data from all 21 sensors deployed on the left rail track. It is observed that the IBFs for the 1st, 6th, and 27th wheels are negative, indicating that the three wheels are defective with the 27th wheel being most heavily defective. The other left wheels are diagnosed as healthy. The values of IBFs provide a quantitative measure to assess the degree of wheel defects. Smaller values of IBF indicate in general worse wheel conditions.To validate the diagnostic results by the proposed online method, offline inspection on the suspected defective wheels was conducted afterwards in a workshop. The offline wheel radius deviation measurement indicates that the 1st, 6th, 24th, and 27th right wheels, and the 1st, 6th, and 27th left wheels are indeed defective, with large flats found on the 24th (36.  mm in length), 27th right wheel (26.  mm), and the 27th left wheel (34.  mm). Although the 31st right wheel is diagnosed as weakly defective by the proposed method, it is in fact healthy. This warns us of the diagnostic risk imposed by the proposed method. Overall, the diagnostic results by the proposed online method are in good agreement with the offline measurement results.## Conclusionproposed in this study. With the aid of an FBG-based track-side monitoring system, CDFs for the normalized FASs of rail foot strain responses in the healthy state of wheels are extracted as characteristic features to train a probabilistic reference model by SBL. In the Bayesian probabilistic framework, the formulated model can account for uncertainties arising from the monitoring data (e.g. measurement noise and variability in the stochastic wheel–rail dynamics) and modeling error, and the SBL enables the model to perform well in either characterizing the training data or predicting unseen data. Because only a few basis functions are involved in the model, its computational efficiency is quite competitive especially on prediction, enabling fast diagnosis in wheel condition assessment. The diagnostic logic in terms of BNHST and scale-invariant IBF allows the unsupervised defect detection to be executed in a fully probabilistic inference context, ranging from the probabilistic model development in the training phase to the wheel defect diagnosis in the testing phase.The proposed method is verified using the in-situ monitoring data acquired by a track-side monitoring system during the passage of a train with all wheels being healthy and with some wheels being defective, respectively, and is validated through comparing the diagnostic results obtained by the proposed online method and by the offline wheel radius deviation measurement. It turns out the following findings: (a) when using CDFs as characteristic features, a sparse representation of the probabilistic model containing only a few basis functions (four Gaussian kernels in the case of the optimal kernel width g = 40) can be obtained tofavorably characterize the stochastic CDFs; (b) the proposed method may give rise to false-negative diagnostic results when using only the monitoring data from a single sensor, but more accurate diagnostic results can be obtained using the monitoring data from all the deployed sensors; and (c) when using the monitoring data from all the sensors, the diagnostic results on the wheel defects and condition by the proposed online method are in good agreement with the offline inspection results. It should be mentioned that the choice of the shifting values h affects the evaluated value of IBF (or its twice the natural logarithm) and therefore has an influence on defect detection results. The value of h is directly related to the significance level (diagnostic risk). In this study, h is set to be 5sMP31S at the price of the diagnostic risk of 1.24% that healthy wheels are falsely diagnosed as defective, and a falsepositive ‘‘defect’’ on the 31st right wheel is falsely alarmed (albeit it is identified to be a very weakly defective according to its IBF). When offline radius deviation measurement results on wheels of different defect extents are available, a more appropriate choice of the shifting values h can be made. Similarly, when the correspondence between the evaluated values of IBF and the real defect extents of defective wheels detected by offline inspection is established, the generic classification intervals defined from a mathematical logic can be refined to be more precise and specific for defect degree classification of the monitored wheels based on the evaluated value of IBF.