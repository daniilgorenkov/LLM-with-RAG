1. INTRODUCTION Advanced condition-based maintenance systems are crucial to improve safety and reducing operational costs. The inspection time for a car by operators depends on the car model and number of the axle. It typically takes several minutes to examine the state of the car's parts for a four-axle car. . In most cases, because of the physical structure of the defects, it's difficult to identify each failure by visual inspection. With the help of Artificial Intelligence and online monitoring systems, maintenance costs can significantly be controlled by reducing unnecessary repair programs. Because of this system, the durability of freight and passenger cars could be increased to guarantee the fleet's overall reliability and safety. Wheel defects were divided into six categories by EN 15313: thermal cracks, shattered rim, plate failures, notching, flange tip and tread surface defects . Wheel flats, which belong to the class of faults on the contact region, are one of the most frequent failure, according to statistics. This standard also defines that base on the axle load, wheel radius, and speed of the train, a wheel flat's maximum flat length ranges from 20 to 80 mm. . According to recent papers, the acceptable limitations are typically 50 to 60 mm flat skid size (length) and 0.  to 1.  mm flat depth [,] . Currently most railways remove wheels with flat of 60 mm or more and because of the safety matters, flat length beyond standards called “High risk” in this paper. Although a little flat, such as 20 mm skid length, may last a long period on the vehicle, it could have substantial negative consequences, including pulse-shaped noises and significant periodic impacts on both rail track and car. Wheel flats are localized surface defects that develop in most cases as a result of local damage or deformation when wheels are stoped by applying the brakes or sliding on the rail  or exceeding the wheel adhesion forces to the rail surface due to: not releasing the brake by the operators (particularly long railroad cars) fast brake implementation, or existance of multiple undesirable elements such as moist leaves between the rail and wheel. The form of the newly sharp edges of the flated wheel quickly chnage into curved edges because of the plastic deformation and wear . Safety and expense should be compared when wheels deviate from relevant standards. In most cases, wheel defects are the main reason for car derailment and cancost up to millions of dollars for the railway industry, so investigating critical wheel failure become essential for rolling stock engineers. Many techniques have been utilized to detect wheel failure, such as wheel flat and out or round issues discussed and developed in this paper. Pythonbased programming was developed to predict wheelset acceleration data history due to wheel defects and track irregularities. After that, a machine learning algorithm is used in order to learn the concept from input data (acceleration signal), just like an operator. A Supervised learning algorithm predicts a target variable from a group of predictive factors named features or attributes. Instead of labeling datasets, unsupervised learning approaches aim to learn the system structure more compactly and understandably for people. Shallow learning and deep learning algorithms are the two basic classes into which machine learning may be separated. level of presentation is the significant difference between these algorithms. Methods of shallow learning described and used in this paper focus on manual feature selection techniques such as support vector machine , decision tree , random forest , K nearest neighbor , and logistic regression  for addressing between attributes and targets . Deep learning systems, however, rarely need explicit characteristics and can directly learn from original data, such as photographs. The deep learning process usually takes more time and requires more powerful hardware to predict object variables. Until now, two primary categories can be used to represent wheel-flat detection methods. Class one refers to detectors installed throughout the railway lines to evaluate every passing wheelset's vertical force or acceleration. One of the tools used most frequently to anticipate and identify wheel flats is Wheel Impact Load Detector , which monitors real-time impact data and alerts railway dispatch when the load is too high. Using machine learning-based prediction models, we have created the system predictor  to anticipate wheel failures before they happen. It can forecast tire flats and calculate when wheels will exceed impact force thresholds. Class two is wayside detectors that monitor the conditions of each passing freight car. Yet, in recent years, network monitoring systems have increasingly used recording and vision inspection devices. Some of these techniques generate a large amount of data to store and analyze.Alemi et al.  list the vibration controling devices, strain gauge-based systems, ultrasoundbased apparatus, acoustic emission monitoring, fiber Bragg grating-based instruments, laser methods as the most widespread condition monitoring techniques for identifying railway wheel defects. Some other detectors, like acoustic bearings and hot box detectors, are also installed along the rail track. In practice, infrastructure managers own and install wayside systems to ensure railway traffic's safe operation. Yet, it is challenging to guarantee constant vehicle monitoring. Onboard techniques are better suited for onboard system servicing of rolling stock based on condition, Compared to wayside approaches. This system is able to gather condition information continuously, allowing not only for defect detection but also for the forecasting of component deterioration that can cause efficient railway operation and maintenance. Due to the accelerometers' low cost and durability, installing them on vehicles as vibration condition monitors has become the industry standard onboard option for flat detection. The accelerometers can be mounted on the axlebox, the bogie frame or the underframe of the car body. Axlebox accelerations were most commonly meant to be used for detection of wheel flat. Jiang et al.  suggested using Empirical Mode Decomposition to extract the defective data of the signal from interferences into numerous intrinsic mode functions by breaking down the original signal. Zhao et al.  investigated a signal in the high-order spectrum that can block Gaussian noise. Liang et al.  analyzed vibration signals of the wheel flat by commonly used methods of time-frequency analysis like Fourier Transform, wavelet transform, and Wigner– Ville transform that can present time–frequency data from wheel flat. A number of unique characteristics were created to characterize the axlebox faulty signal patterns in addition to statistical data. Bosso et al.  proposed a time-domain wheel flat severity score that combines RMS and peak values. Bernal et al.  investigated the detectability of wheel flat for Y25 bogie of freight vehicle employing axlebox, bogie, and carbody using multi-body dynamics simulation. The suggested indications may accurately represent the faulty signal brought on by wheel flat in axlebox and bogie accelerations because they are based on time-domain crest values, dominant frequency in the envelope spectrum and time-domain RMS values to establish a threshold of the listed attributes based on an observational study.Regarding wheel flat identification using carbody accelerations, The techniques suggested in Bernal's and Bosso's studies were less successful with carbody accelerations. In the course of an offline check, the wheel flat's length is usually monitored. While all other features of the vehicle stay constant, several investigations have demonstrated a deterministic link between the vertical axlebox vibration signal (vertical force of the wheel-rail), the wheel flat length and vehicle speed . This study tries to develop a wheel-flat length predicting method that relies on the standard configuration of car speed, car weight, wheel/rail profile, track geometry, and track irregularities. Numerical simulations have been used to develop and evaluate a specific algorithm. This work aims to create a practical algorithm to handle the designed system. Knowing the importance of these parameters is necessary to build an online identifier of wheel flat length using acceleration data from the axlebox. For railroad vehicles, condition-based monitoring might incorporate this technology. Hardware that is now available allows for the measurement of axlebox acceleration and vehicle speed in actual operation. With the help of a storage database or online signal inspection, the computer can detect the behavior of the signal at specific time intervals. This means that the vertical acceleration signal data and the car velocity at certain ridding conditions should determine the length of wheel flats. This designation results in saving time and resources. 2. METHODOLOGY 2.  Evaluation matrix In this paper, "wheel flat" is defined as positive and "undamaged wheel" as a negative state. P represents the total amount of the dataset’s real positive case, while N stands for the number of the dataset’s true negative case. TP (true positive) indicates the number of positive cases that were successfully categorized and the number of successfully organized negative case is marked as TN (true negative). The number of false classifications of positive case is FP (false positive, i.e., false warning). The number of incorrect classifications of negative case is FN (false negative, i.e., An error in judgment). Therefore, the precision value is defined as: TP  precision , (2) P While the recall is calculated as follows:TP recall  , (3) TP  FN While a higher recall indicates a higher ability to recognize wheel flats, a better precision suggests fewer false alarms. Furthermore, accuracy is calculated by TP and TN over P and N, that shown below : TP  TN accuracy  . (4) TP  TN  FP  FN A numerical model is developed in Universal Mechanism multi-body dynamic software to understand axlebox acceleration behavior for wheel flat defects, as illustrated in **Fig. 1** . The numerical model with a rigid body is expected to have a more intense response versus the real case based on Zhu's paper . The numerical method relies on rigid bodies; consequently, this paper does not consider the system's response at high frequencies and the stimulation of flexible modes. **Fig.  Wheel flat on a wheel's running surface and an example of the impact caused by the flats**  2.  Research objects Many defects and operational situations are studied in relation to the impact on axlebox acceleration signals using numerical methods. Numerical simulation, extraction of features, and problem forecasting are examples of numerical techniques. Passenger cars are used in the paper because, first of all, the passenger's safety is the top priority for any community; on the other hand, accessibility of power sources because of energy supply for the onboard monitoring system is an important issue . Although a potential freight carsolution uses energy harvesting devices like axle generators, sometimes batteries or solar energy may be helpful for tracking and monitoring. The vibration signal data are collected and transformed to a Python format for processing the acceleration signals. The maintenance and traffic schedule document, along with the measurement circumstances, serve as the foundation for the tests' selection and the database's raw data extraction. The traffic records, also known as time history data, are used to pre-process the vibration data in Python. As a result, vibration data are gathered for a particular day, sector, speed, and accelerometer. Once the defective signals have been eliminated, feature scaling is used to standardize the independent variables in most real-world datasets, which typically contain features with significantly different sizes, units, and ranges. Normalization is the following action. This procedure should be carried out since feature scale diversity can impact the performance of many machine learning algorithms, leaving a collection of integrated vibration signal information that organized by the accelerometer. The combined signal are then processed in the time domain, and the outcomes are examined . 2.  Recording parameters and measurement apparatus The simplicity of axlebox acceleration measurement's implementation and maintenance in less expensive trains is a significant benefit. The detection approach for wheel flats presented in this paper uses installed accelerometers to measure axlebox vibration. In the railroad sector, numerous non-destructive techniques are used to examine the status of the wheel and its associated subsystems. When the car is in its path, wheel/rail interaction generates acceleration signals in three axes by accelerometers and can be monitored online to observe signals. The wheel inspection data may differ based on the type of defect and measurement methods. Using one direction (vertical acceleration) measuring devices generate less data and have less processing time than three-axis accelerometer devices. Then processed vertical acceleration data can be stored in a cloud-based storage database and used later by a shallow learning algorithm to predict the height of flat wheels. 2.  Wheel flat detection algorithms The measured acceleration value on the axlebox, bogie, or car body is closely relative to the parameters of each fault. For instance, for flat wheels, acceleration amplitude is proportional tothe flat depth or skid length that makes contact directly with the rail per each revolution at each speed level. A periodic impulse happens when a damaged wheel rotates because the flat of the wheel is exposed to the track at a particular frequency. After determination of the vehicle velocity ( V ) and wheel radios ( rw ), The periodic impulse's frequency, which refers to the flat impact frequency, can be calculated as follows: V f  [ Hz ], (5) 2  r w For a maximum speed (120 km/h), the computed time estimation of the defective wheel is about 0.  s. Therefore, the step size or sampling rate for achieving higher average accuracy in machine learning algorithms is considered 0.  s (1000 Hz). The simulation steps can be illustrated in **Fig. 2** . The designed system works by collecting signals (acoustics, displacements, acceleration and etc.) relevant to operational features or behavior of the components, determining the presence or absence of a developing defect and determining the intensity of the fault before it fails . A model-based approach is utilized when it is possible to identify the link between the input (profile of defective wheel, track-vehichle parameter and train velocity) and output signals; alternatively, a signal-based method can be employed when there are just output signals available. Whenever multiple signals are added, low-pass filtering and finding local maxima beside cross-correlation is neccesery. The system’s output data of is also used to identify a specific issue using higher ratio of defective area samples with minimum distance to the total number of defective datasets. When the signal is analyzed through simulations, it is compared to a created defective situations datasets that could studied in frequency, time, and time-frequency domains. At the end, new samples are being interpolated and similarity of these data sets is also reported.Wheel flat simulation Select wheel flat lengths and vehicle speed by uniform experimental design sampling principles Data extraction in Um Machine learning techniques With selection of proper machine learning algorithm, vehicle’s speed and acceleration signal behavior is been trained to predict wheel flat height Wheel flat producing Tracking data acquisition passenger car speed of v and axle box acceleration signal a Validation **Fig.  designed process of wheel flat detection by machine learning algorithms** On the other hand, there are faults like a crack in the wheel rim surface that can be recognized throught image processing techniques, including deep learning algorithms. Therefore, classifying structural defects and geometry irregularities is vital to determine which algorithm is proper for each defect.3. MODELING AND SIMULATION 3.  Car Dynamics Model According to **Fig. 3** , a 3D model single-passenger car from Universal Mechanism library is imported to simulate and investigate the effect of the different classes of flat length on acceleration signal at each speed class. **Fig.  passenger car 3D multi-body dynamics in Universal Mechanism** A single car body, four wheelsets two bogie frames, eight axleboxes are included in the model. In the vertical direction the axlebox has one degree of freedom, compared to the six degrees of freedom of the wheelset, the bogie frame and car body. According to **Fig. 4** , the system comprises 15 rigid bodies that contains eight dependent degrees of freedom 42 independent degrees of freedom. **Fig.  schematic of single flat-wheeled train dynamics model**  With the aid of Universal Mechanism simulation, we designed three levels of alarm that noticeheight and skid length is illustrated in **Fig. 5** . As shown, flat parameters are function of rw and θ and generally value of both of them depend on wheel profile type. Although actual wheel is not the ideal circle, there’s random roughness on the wheel surface and sometimes has polygonal wear, which will lead to low wheel-rail impacts. By randomly generating track irregularity, the smooth change in acceleration level of non-circle shape of the wheel can be covered. **Fig.  Geometry of a sharp edge wheel flat**  Three warning stages were determined for safer ridership, that shown in **Table 2** . Python is used to fully automate the generation of a wheel flat in the Universal Mechanism. **Table 2 Classification of wheel flat classes as a function of flat height** Class number Warning stage Skid length (mm) Flat height (mm) 1 High risk 80 1.  2 Danger 60 0.  3 Danger 40 0.  4 Low risk 20 0.  5 Low risk 10 0.  The vibration response amplitude will be decreased whenever rounded edges are used instead of sharp edges because of fewer interruptions between the wheel and rail. Although sharp edges are likely to cause the vibration response to be exaggerated and in modeling and simulating a wheelflat, in order to simplify the geometry, only sharp edges are taken into account . A simulation is done under the conditions of the sampling rate (frequency) is 1000 Hertz for duration of 10s and total sample of 10000 for each flated wheel. A 10 mm wheel flat length, car speed of 100 km/h, and FRA class four the track irregularity because of similar track condition in Iran in most cases is selected. Vertical axlebox vibration response of the vehicle with a 10 mm flat length was estimated through Universal Mechanism and displayed in **Fig. 6** . **Fig.  An example of axlebox acceleration with 10mm flat length at 100 km/h** Among many parameters that may affect axlebox acceleration, some are very important because of their direct influence on impact amplitude. Some of these parameters are less important, like car weight, rail profile, wheel profile, and track geometry. For example, if you consider two different wheel profiles of UIC60new and UIC 510-2 (D1000-d760), the result shows that most of the statistical features of these two separate signals that are going to be used in machine learning are closely the same, and so it can be named as an unimportant factor. Some of theeffecting parameters are mentioned and detailed in the following sections. 3.  Track Irregularity Effect The geometrical parameter of tracks largely influences vehicle vibration status. The sensitivity of the axlebox vibration response varies depending on the track conditions, which may interfere with the wheel flat assessment. There are a lot of accessibility for irregularity signals input type like expression (functions), points (creat dataset manually), spectrum ( FRA, UIC and ERRI diffrenet classes) and slump (using scale factor for setting an amplitude) in both vertical and horizontal direction which can be generated randomly many times. In other simulations, track irregularity of UIC-Good is used to study the effect of condition of the track on the wheel flat detection. The other parameters remained unchanged. **Fig. 7** demonstrates the two situations' vertical axlebox acceleration time histories. Knowing that the track irregularity condition of the ERRI-High is worse than the UIC-Good, the importance of this parameter shows up and may interfere with the detection of given time history acceleration to machine learning algorithms. The effect of track lateral irregularity is so low that coulde be ignored and on the other hand, existence of it doesn’t interfer detection process. **Fig.  Influence of track condition at the speed of 90 km/h with 20 mm flat length**3.  Speed Effect The increase in the car speed affects the axlebox vibration response directly. The axlebox acceleration is measured by four speeds class of 30, 60, 90, and 120 km/h for a 20 mm wheel flat length at low frequency (for better demonstration), shown in **Fig. 8** . Outcomes showed that in higher speed groups, because of higher impact amplitude, separation and detection of defect classes will become more accessible for the machine learning algorithm, and higher accuracy will be achieved. These four speed range are compatible with travel condition of most car types in Iran and could easily used for flat size prediction. **Fig.  Influence of Speed at the flat length of 20 mm** 4. RESULT AND DISCUSSIONSeveral factors like vehicle velocity, track irregularity and physical condition of the vehicle, constantly impact the axlebox's vibration signals. Additionally, the typical situation of wheel-rail rolling contact also causes numerous vibrations to be produced. Extracting the issue-relevant features in wheel defect detection utilizing axlebox acceleration is challenging from the raw vibration signal. Some conventional techniques enable changing or deleting bad data with average values caused by resonance or inappropriate measuring by the operator or hardware. After data selection (normalized and standardized) correctly, all the data is given to five different machine learning algorithms to categorize and memorize time history acceleration signals at specified travel conditions. The assessment factors, like accuracy, precision, F1 score, and recall, were compared at different speed classes. After the dedication of the proper value of the test-totrain ratio (20% for the test and 80% for the train), the results of the train sets at each class were reported. With mentioned configuration, 50 simulations with different random FRA class 4 were done to establish a confident model of prediction of wheel flat at each speed and height class. In the end, the total number of the variant was 20 (four speeds and five height classes), and for the 50 simulations, 1000 datasets were achieved to create and develop the model. A low value of 38% up to 51% of the training dataset for K Nearest Neighbor algorithm shows that this algorithm is incapable of reading and classifying train set data and thus is not a proper algorithm to predict flat height class at four speed classes. Thus, it could not be an accurate prediction algorithm for validation too. Other algorithms could classify training data above 98%, which is acceptable. 4.  Interpretation of statistical tests The result of the test (validation) data at 30 km/h is shown in **Fig. 9** . Both decision tree and random forest offer good prediction accuracy for this speed class. One of the essential features of prediction in both test and train that should be discussed in evaluation results is confusion metrics that are also shown for the decision tree algorithm (best accuracy) in **Fig. 10** . In some points, in prediction and true labels of 10 mm and 20 mm, we realized that many of these predictions might be wrong in the class of 30 km/h because of the closeness of data amplitude (acceleration data). It should be mentioned that these errors can be ignored in those length classes because of the low risk for passenger cars. On the other hand, for 40 mm and higherlengths, results show good predictions and could be both functional and reliable. The decision tree algorithm had the best accuracy of 80%. **Fig.  Test evaluation indicators for the speed of 30 km/h****Fig.  Confusion matrix for the speed of 30 km/h** The result of the prediction for the speed class of 60 km/h is shown in **Fig. 11** . In this class, balanced accuracy is 88% for the decision tree. **Fig. 12** also shows confusion metrics for the decision tree. For example, for true label of “flat 20 mm” ten predictions were labeled as “flat 40 mm” which were totally wrong and would decrease balanced accuracy. In compression with speed class one, almost all classes received acceptable scores to detect the flat heights, and that's because of better distribution of data rather than speed class of 30 km/h, so in general, it's better to rely on the actual test that conducted over 60 km/h in order to achieve precise values.**Fig.  Confusion matrix for speed of 60 km/h** For the speed of 90 km/h, logistic regression and decision tree have higher accuracy than other algorithms. As shown in **Fig. 13** , the highest average accuracy is 87% which belongs to the decision tree. According to **Fig. 14** , the result of the confusion metrics also indicates that the detection of class height is done perfectly. However, there is a low error for designation in order of 10 mm and 20 mm flat length which is negligible because of safety standards in these heights, according to **Table 2** . Other flat length shows reliable scores in this speed class.**Fig.  Confusion matrix for the speed of 90 km/h** At the speed of 120 km/h, we noticed that the accuracy value significantly increased, and the reason could be because of the high amplitude of acceleration signals, which facilitate the detection of wheel flat height for almost all algorithms except "K nearest neighbor," according to **Fig 15** . The best accuracy obtained in this speed class was 96% for the decision tree. Confusion matrix **Fig. 16** also shows a good agreement between the predicted and true labels of flat heights. In decision Trees, the starting point begins from the tree's root for predicting a class label for a record. In this paper, because of the existence of only one attribute, acceleration value in the aspect of statistical features is constantly compared with trained or memorized data, so it splits the nodes on all available attribute and then consider the selected share which results in the most homogeneous sub-nodes and causes reasonable and prefect classification of wheel flat heights.**Fig.  Confusion matrix for the speed of 120 km/h** After designing a condition-based monitoring system and training the best model for predicting wheel flat heights, extracted data from the accelerometer should be separated into 10-second intervals with mentioned step size and then given to the system to detect the flat height of each passenger car wheel. This system could be online or cloud-based to monitor the fleet's condition. 5. EXPERIMENTAL TESTS The algorithm has been verified by taking into account vehicle experimental tests. The GPS system determined the vehicle's speed and recorded its precise location. A three directional sensor that was mounted on the wheelset (axlebox) was used to measure the accelerations, and its sampling frequency was 5 kHz. A 20 mm wheel flat was artificially built by the author's technical support group on the wheel tread produced by the grinding tool. The field test provided the measurement data used in this paper. In 2016, the instrumented tank wagon with the Y25 bogie was used on the German railroad  and **Fig. 17** displays the axlebox acceleration and speed data collected by the integrated monitoring detection system on the tank wagon. The graph demonstrates a relationship between the axlebox vertical acceleration's amplitude and vehicle speed when operating with a flat tire: The acceleration amplitude increases with vehicle speed**Table 3. primary parameter of tank car** Notation Parameter Value ts simulation step time 0.0002 s mcar mass of the car body 67350 kg mbogie mass of the bogie 1990 kg mwheelset mass of the wheelset 1178 kg Jcx car body mass moment of inertia around the x 97521 kg.m Jcy car body mass moment of inertia around the y 821325 kg.m Jcz car body mass moment of inertia around the z 810181 kg.m Jbx bogie mass moment of inertia around the x 1188 kg.m Jby bogie mass moment of inertia around the y 1484 kg.m Jbz bogie mass moment of inertia around the z 2582 kg.m Jwx wheelset mass moment of inertia around the x 902 kg.m Jwy wheelset mass moment of inertia around the y 108 kg.m Jwz wheelset mass moment of inertia around the z 906 kg.m cz bogie vertical stiffness of one/double spring 4004.  KN/m Rw wheel radius 0.  m **Fig 18. Simulated car with the running speed of 82.  km/h with a single 20 mm flat length in Universal Mechanism**6. CONCLUSION This study analyzed the detection of wheel flat height on a passenger car with machine learning techniques by wheelset acceleration signals. Moreover, important factors like track irregularities and vehicle speed on axlebox acceleration have been investigated. The most important results are as follows:  Because of the importance of safety issues for a passenger in a passenger car, conditionbased monitoring can increase safety factors, save much time by visual inspections, and save money for railway administrations.  After dedicating necessary parameters to the multi-body dynamic software (Universal Mechanism) and repeating the simulation for 50 times at each height and speed class, all trained data is given to the machine learning algorithms to predict wheel flat height at given car speed.  With proper step size and simulation time, more than 1000 data sets were used to set the train to test (validation) ratio of 80% to 20% for achieving the best-balanced accuracy for five different machine learning algorithms.  The decision tree algorithm had the best balance accuracy of 87.5% and selected as a diagnose (prediction) model, while the K nearest neighbor algorithm had the worst balance accuracy of 38%, which is not desirable  As the speed of the passenger car increase, because of the rise in acceleration amplitude, the accuracy value significantly increases from 80% to 96%. For better results, we suggest using 90 km/h in real cases.  The designed system is also capable of the designation of many surficial defects of rail and wheel, like rail irregularity classes, wheel polygonization and wheel flat depth are going to be investigated in the subsequent investigation. Funding: This research did not receive any specific grant from funding agencies in the public, commercial, or not-for-profit sectors.