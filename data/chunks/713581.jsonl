{"text": "## Smart railways: AI-based track-side monitoring for wheel flat identification## Mohammadreza Mohammadi , Araliya Mosleh , Cecilia Vale , Diogo Ribeiro , Pedro Montenegro  and Andreia Meixedo## AbstractThe wheel flat detection in trains using Artificial Intelligence (AI) has emerged as a critical advancement in railway maintenance and safety practices. AI systems can effectively identify geometric deformation in wheel rotation patterns, indicative of potential wheel flat damage, resorting to wayside monitoring systems and machine learning algorithms. This study aims to propose an unsupervised learning algorithm to identify and localize railway wheel flats, which considers three stages:", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 0}}
{"text": ". This study aims to propose an unsupervised learning algorithm to identify and localize railway wheel flats, which considers three stages: (i) wheel flat detection to distinguish a healthy wheel from a damaged one using outlier analysis, achieving 100 percent accuracy; (ii) localizing the damage to pinpoint the location of the defective wheel through the Hidden Markov Model (HMM); (iii) classification of wheel damage based on its severity using k-means clustering technique. The unsupervised learning algorithm is validated with artificial data attained from a virtual wayside monitoring system related to freight train passages with healthy wheels and defective wheels with single and multiple", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 1}}
{"text": "rom a virtual wayside monitoring system related to freight train passages with healthy wheels and defective wheels with single and multiple defects. The proposed methodology demonstrated efficiency and robustness for wheel flat detection, localization, and damage severity classification regardless of the number of defective wheels and their position.## IntroductionDefective wheels on railway vehicles significantly impact both railway infrastructure and vehicle systems. Continuous train operation with defective wheels raises the risk of track misalignment and potential derailments. Over time, the persistent impact of defective wheels can structurally damage railway vehicles and their componen", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 2}}
{"text": " and potential derailments. Over time, the persistent impact of defective wheels can structurally damage railway vehicles and their components, compromising integrity and longevity. Thus, monitoring the geometrical quality of railway vehicle wheels to detect and classify wheel defects based on severity is essential, particularly for freight trains.[–]The anticipated shift of goods transport from road to rail in the coming years heightens the need for effective wheel condition monitoring. Defects in freight trains can cause derailments, affecting railway operations. This necessitates novel solutions for the automatic detection and classification of out-of-roundness (OOR) wheels.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 3}}
{"text": "cting railway operations. This necessitates novel solutions for the automatic detection and classification of out-of-roundness (OOR) wheels. OOR defects can induce vibrations, damaging both track and vehicle components. These defects include flats, eccentricities, polygons, corrugations, missing tread material, and other irregularities.[–] Wheel flats, a common type of wheel damage, can be caused by braking forces that change the wheel’s perimeter shape from round to flat. The General Contract for the Use of Wagons mandates the immediate replacement of wheelsets with flats longer than 60 mm on wheels larger than 840 mm.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 4}}
{"text": "al Contract for the Use of Wagons mandates the immediate replacement of wheelsets with flats longer than 60 mm on wheels larger than 840 mm. Therefore, early automaticdetection of defective wheels is crucial for safety, track reliability, and controlled maintenance costs.Defective wheels can be detected using wayside or onboard monitoring systems. Onboard techniques[,] require all vehicle wheels to have sensors, leading to high costs. To mitigate this, wayside measurement systems are commonly used, monitoring wheels of all vehicle types during train passage. Various sensors, such as fiber Bragg gratings,[,] acoustic emission sensors,[,] strain gauges,[,] and accelerometers,[,][,] are employe", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 5}}
{"text": "age. Various sensors, such as fiber Bragg gratings,[,] acoustic emission sensors,[,] strain gauges,[,] and accelerometers,[,][,] are employed to detect wheel flats.Innovative automatic detection methods are continually enhancing result reliability. Mosleh et al. used the envelope spectrum method to distinguish defective wheels and successfully tested on polygonal wheels. Chen et al. developed a two-level adaptive chirp mode decomposition (ACMD) approach for wheel flat detection using vehicle1 CONSTRUCT – LESE, Faculty of Engineering, University of Porto, Porto,## Numerical modelingThis section presents the numerical simulations of the train, track, and the interaction between the wheel and t", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 6}}
{"text": " Porto,## Numerical modelingThis section presents the numerical simulations of the train, track, and the interaction between the wheel and the rail. Moreover, the proposed virtual wayside monitoring system for wheel flat detection, localization, and damage severity classification is also described in this section.In the present study, simulations of the numerical dynamic interaction between trains and tracks are performed using the in-house software Vehicle-Structure-Interaction (VSI), allowing the generation of synthetic measurement responses. The Vehicle-structure interaction software is described in detail in the study of Montenegro and Calçada.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 7}}
{"text": "f synthetic measurement responses. The Vehicle-structure interaction software is described in detail in the study of Montenegro and Calçada. This numerical tool, developed in MATLAB, imports the structural matrices from the structure (in this case, the track) and the vehicle that has previously been modeled in a Finite Element (FE) package. In spite of the fact that these subsystem models are originally created individually in the FE program, the VSI software uses a fully linked technique to couple them. The train is coupled to the track by a 3D wheel-rail contact model using Hertzian theory. Normal and tangential contact forces caused by rolling friction creep are calculated by the USETAB r", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 8}}
{"text": "il contact model using Hertzian theory. Normal and tangential contact forces caused by rolling friction creep are calculated by the USETAB routine. Moreover, The simulation of the track is conducted using the software ANSYS. Beam elements are used to model rails and sleepers, while spring-dashpot components are used to simulate the behavior of the track flexible layers, that is, ballast, fasteners/pad, and mass point components to consider the ballast mass. ANSYS has also been used to model the train, which is a freight Laagrss-type vehicle composed of five wagons, each one with two axles. The train modeling uses a multibody formulation in which mass point elements are placed at the center o", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 9}}
{"text": "ive wagons, each one with two axles. The train modeling uses a multibody formulation in which mass point elements are placed at the center of gravity of each body, specifically the carbody and wheelsets, allowing inertial and mass effects to be simulated. The work of Mosleh et al.[,] thoroughly describes in detail the mechanical characteristics of both the track and train components. The graphical depictionof the numerical simulation of the wayside monitoring system is shown in Figure 1.In the authors’ previous studies,[,] different sensitivity analyses have been implemented to evaluate the effect of the sensors position on the accuracy of the proposed methodology for wheel flat detection.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 10}}
{"text": "s have been implemented to evaluate the effect of the sensors position on the accuracy of the proposed methodology for wheel flat detection. From the results of the mentioned studies, the proposed methodology can detect wheel flat regardless of the number and position of the accelerometers installed on the rail or sleeper. The location of the sensors in the proposed virtual wayside monitoring system is shown in Figure 1(d). The wheel flat-identification system is composed of eight accelerometers installed on the midspan of the right and left rails. The accelerometers on the right side are identified by measurement points 1 to 4.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 11}}
{"text": "ters installed on the midspan of the right and left rails. The accelerometers on the right side are identified by measurement points 1 to 4. Additionally, the accelerometers located on the left side of the track are represented by measurement points 5 to 8. The distance between the accelerometers is considered equal to 0.  m. Moreover, one strain gauge is installed on the midspan near the accelerometer 1 to obtain strain for the damage localization process (stage 2).## AI-based methodology for wheel flat identificationIn this research, the proposed methodology to identify wheel flat automatically includes three stages, as presented in Figure 2, according to a machine learning methodology[,][", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 12}}
{"text": "dology to identify wheel flat automatically includes three stages, as presented in Figure 2, according to a machine learning methodology[,][,] :In the first stage, the rail baseline responses are used to establish a confidence boundary, while the second stage localizes the defective wheels and distinguishes single-damage from multi-damage passages. Finally, the third stage identifies the severity of the damages and classifies them into three categories (low, moderate, and severe damage).## Stage 1: DetectionDamage detection is performed by applying six distinct steps which are shown in Figure 2. First, data acquisition collects dynamic responses from accelerometers.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 13}}
{"text": "erformed by applying six distinct steps which are shown in Figure 2. First, data acquisition collects dynamic responses from accelerometers. Next, feature extraction reduces the data dimension using Continuous Wavelet Transform (CWT) to convert timeseries data into damage-sensitive features. Principal Component Analysis (PCA) then mitigates environmental and operational effects on vibration characteristics. PCA is used to reduce model orders, perform modal analyses, update nonlinear models, validate sensors, and locate damage. Afterward, features are merged into a damage index (DI) using Mahalanobis Distance (MD), simplifying data analysis by reducing multivariate data to a single DI.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 14}}
{"text": "are merged into a damage index (DI) using Mahalanobis Distance (MD), simplifying data analysis by reducing multivariate data to a single DI. MD measures the similarity between undamaged and damaged features; shorter distances indicate higher similarity. Data fusion enhances damage sensitivity for CWT-PCA-based features. An unsupervised discrimination algorithm defines a confidence boundary (CB) for each accelerometer usingoutlier analysis. Mahalanobis squared distance is approximated by chi-squared distributions, allowing a Gaussian distribution for MD. The Gaussian inverse cumulative distribution function (ICDF) estimates the CB for outlier detection, considering the baseline featurevector’", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 15}}
{"text": "The Gaussian inverse cumulative distribution function (ICDF) estimates the CB for outlier detection, considering the baseline featurevector’s mean and standard deviation. A feature is an outlier if its damage indicator meets or exceeds the CB, with a 1% threshold based on Sousa Tom´e et al. and other works.[,][,] Finally, defective scenarios are identified and used to localize damaged wheels.[,]## Stage 2: LocalizationThe method divides the signal to capture detailed vibration patterns to localize a defective wheel, aiding in obtaining specific characteristics in both time and frequency domains. This segmentation counts and labels each wheel’s passage, allowing further analysis of wheel-rail", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 16}}
{"text": "istics in both time and frequency domains. This segmentation counts and labels each wheel’s passage, allowing further analysis of wheel-rail interactions. The Hidden Markov Model (HMM) is chosen for its processing speed and ability to link observation sequences to hidden states. The Baum-Welch algorithm deduces model parameters using an Expectation-Maximization strategy, while the Viterbi and Forward-Backwards algorithms define probability vectors and grids. This method links reliable signal sections to the associated wheel, enhancing the examination of wheelrail interactions and pinpointing specific points for comparing patterns across wheel movements.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 17}}
{"text": "ed wheel, enhancing the examination of wheelrail interactions and pinpointing specific points for comparing patterns across wheel movements. Gaussian emissions between 2 and 5 states were considered for adjusting hyperparameters, with a 3-state HMM chosen for segmentation as it effectively eliminated segments between wheel movements.The segmentation captures three phases of a wheel’s movement: approach, detection, and departure from the sensor. This detailed segmentation helps identify the effects of a defective wheel on the accelerometer signal. With wheel damage, the accelerometer signal’s amplitude varies, while the strain gauge signal remains consistent, facilitating automatic segmentati", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 18}}
{"text": "eel damage, the accelerometer signal’s amplitude varies, while the strain gauge signal remains consistent, facilitating automatic segmentation of significant signal portions for each passage. Following segmentation, axles are individually counted and separated, and defective wheels are localized based on acceleration peak variations in both single and multi-damage scenarios. These scenarios can be distinguished by specific amplitude variation trends, as discussed in the results and discussion section for wheel flat localization.## Stage 3: ClassificationDamage classification is performed to categorize defects based on the defect severity.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 19}}
{"text": "for wheel flat localization.## Stage 3: ClassificationDamage classification is performed to categorize defects based on the defect severity. For this proposal, the firstoutput of the second stage, the cut signals corresponding to axles with defective wheels, is used as input data in the third stage. Afterwards, to reduce the size of the dynamic response matrices, feature extraction is conducted. For this intention, the CWT is used to convert time-series data into features sensitive to the damage. Afterward, the sparse autoencoder is implemented to estimate input variables (reconstruction). The encoder component transforms the input data yj into a lower-dimensional space S and produces an out", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 20}}
{"text": "te input variables (reconstruction). The encoder component transforms the input data yj into a lower-dimensional space S and produces an output represented as byj. The autoencoder process for each layer L is described as follows:In which, n represents the number of elements in the acceleration response vector, yj denotes the jth element in the original CWT-based damage-sensitive feature response data, byj represents jth element in the reconstructed CWT-based damage-sensitive feature response data. w, w and bh, b h[are the weight matrices and bias vectors] for encoder and decoder modules, respectively, while φ, φ are the activation functions of the encoder and decoder.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 21}}
{"text": "atrices and bias vectors] for encoder and decoder modules, respectively, while φ, φ are the activation functions of the encoder and decoder. The cost function utilized for training the sparse autoencoder is a modified version of the mean squared error function, shown as follows:Where, λ represents the coefficient for the regularization term, β represents the coefficient for the sparsity regularization term and ρ denotes the average desired information gain, which reflects the sparsity proportion, while bρj is the average information gained in the training process. The Kullback-Leibler divergence is a mathematical function used to quantify the disparity between two distributions.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 22}}
{"text": "n the training process. The Kullback-Leibler divergence is a mathematical function used to quantify the disparity between two distributions. In this case, it considers a zero value when ρ and bρj are identical and escalate as they move further apart. Minimizing the cost function makes this term small; therefore, ρ and bρj become close to each other. For the training process of the SAE model, the Scaled Conjugate Gradient algorithm (SCG) with stopping criteria when the model achieves the maximum number of epochs. Thereafter, Mean Squared Error (MSE) and Mean Absolute Error (MAE) are computed between original CWT-based features yj and reconstructed ones byj as new features by equations (4) and", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 23}}
{"text": "ean Absolute Error (MAE) are computed between original CWT-based features yj and reconstructed ones byj as new features by equations (4) and (5), respectively:It is possible to differentiate between defect severities through calculated errors (MSE and MAE). Defective wheels with low, medium and, severe damage come with lower, medium and, higher MSE and MAE, respectively. Data fusion is implemented by computing Mahalanobis Distance to increase the sensitivity of the features (MSE and MAE) to the damage. Data fusion can involve two steps. Firstly, the computed MSE and MAE from the autoencoder are merged for each sensor separately (feature fusion).", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 24}}
{"text": "fusion can involve two steps. Firstly, the computed MSE and MAE from the autoencoder are merged for each sensor separately (feature fusion). Secondly, the MSE and MAE from all sensors are fused in the subsequent step. A diagram depicting the employed SAE architecture is shown in Figure 3 as follows:Finally, the k-means clustering technique is applied to classify damage severities, necessitating the predefining number of clusters. To determine the appropriate number of classes, the global silhouette index (SIL) is used. Through the k-means algorithm, the centroid (CD) of each cluster is then identified. The k-means clustering is implemented through the following equation:Where p is the number", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 25}}
{"text": "centroid (CD) of each cluster is then identified. The k-means clustering is implemented through the following equation:Where p is the number of the damage indexes (DI), x, and c represent each DI and centroid of each cluster, respectively.## Damaged and undamaged scenariosIn order to test and validate the automatic wheel flat identification method developed in this study, baseline (undamaged) and damaged wheel scenarios are considered. The baseline scenario describes the train passing with healthy wheels, whereas the damaged scenario represents a train passing with defective wheels. As shown in Figure 1, three defective layout cases are considered for the damage scenarios, including one sing", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 26}}
{"text": "assing with defective wheels. As shown in Figure 1, three defective layout cases are considered for the damage scenarios, including one single damage and two multi-damage scenarios: (i) flat in the left wheel of the rear wheelset of the third wagon corresponding to single-damage scenarios which is presented in red color ), (ii) defects on the left wheel of the rear wheelset of the first wagon and the left wheel of the front wheelset of the last wagon which is presented with blue wheels correspond to multi-damage scenarios ) and, (iii) flats in the left wheel of the rear wheels of the first and second wagon are shown in blue, related to multi-damage scenarios ).To simulate defective wheels on", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 27}}
{"text": "heel of the rear wheels of the first and second wagon are shown in blue, related to multi-damage scenarios ).To simulate defective wheels on train, different wheel flat severities are also taken into account in this study. Based on the wheel flat lengths (L), three intervals are defined for defective wheels, namely low, moderate, and severe. In each interval, the uniform distributions U (10, 20), U (25, 50), and U (55, 100) define the lower and upper limits for the wheel’sflat length, respectively. The wheel flat depth (D) is computed by the following equation :in which Rw and L represent the radius of the wheel and the length of the flat length, respectively.", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 28}}
{"text": " is computed by the following equation :in which Rw and L represent the radius of the wheel and the length of the flat length, respectively. Moreover, a wheel flat’s vertical profile is calculated as follows :where x is the coordinate aligned with the track longitudinal direction, and H represents the Heaviside periodic function. In real-world conditions, where rails are not completely smooth, track irregularities significantly affect wheel-rail contact force values.[,] Thus, it is important to consider these irregularities even though they are very small in the numerical analyses. In accordance with the European Standard EN 13848-2, rail unevenness profiles are generated for wavelengths bet", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 29}}
{"text": "l in the numerical analyses. In accordance with the European Standard EN 13848-2, rail unevenness profiles are generated for wavelengths between 1 m and 75 m. Using actual data, PSD curves are developed to create artificial unevenness profiles. An overview of how unevenness profiles are generated can be found in Mosleh et al. In order to apply the proposed methodology, dynamic responses are measured at sensors (shown in Figure 1(d)) along the rail in both baselines (undamaged) and damaged scenarios whose assumptions are indicated in Table 1.For the baseline scenario, 113 simulations are performed, as shown in Figure 4, by considering fourunevenness profiles of the rail, five train speeds (va", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 30}}
{"text": "ine scenario, 113 simulations are performed, as shown in Figure 4, by considering fourunevenness profiles of the rail, five train speeds (vary between 40 and 120 km/h), and six loading schemes: (i) empty train; (ii) half-loaded train; (iii); fully loaded train with longitudinal and transversal unbalanced loads (UNB1, UNB2, and UNB3). The unbalanced loading schemes for the wagon model are defined based on the UIC loading guidelines, where the cargo gravity centre is offset in longitudinal and transversal directions. Additionally, the ratio between reaction forces in the axles is described in Figure 4, in which E1, E2, R1, and R2 represent reaction forces in the front, rear, left, and right ax", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 31}}
{"text": "n forces in the axles is described in Figure 4, in which E1, E2, R1, and R2 represent reaction forces in the front, rear, left, and right axles, respectively. To simulate damaged cases, 42 scenarios are considered with different flat geometries while the train speed is 80 km/h containing 30 ton load per wagon.  simulations include the train passing with one damaged wheel, and the other 12 simulations involve multi-damage cases. In the case of single damage, 30 analyses are conducted for each flat length interval (low, moderate, and severe), as illustrated in Table 1.For multi-damage scenarios, 12 analyses are performed .", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 32}}
{"text": "for each flat length interval (low, moderate, and severe), as illustrated in Table 1.For multi-damage scenarios, 12 analyses are performed . Six of these analyses involve two defective wheels with the same severities, namely (low-low, moderate-moderate, and severe-severe) for both the first and second wagons (train passages 31, 32, and 33), identified as far-multi-damaged ), as well as for both first and last wagons (simulations 37, 38 and 39), termed near-multi-damaged ). Additionally, six analyses examine two defective wheels with different severities, including low and moderate, low and severe, and moderate and severe flat properties (train passages 34, 35, and 36), for both the first and", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 33}}
{"text": " including low and moderate, low and severe, and moderate and severe flat properties (train passages 34, 35, and 36), for both the first and last wagons ), as well as for the first and second wagons for simulations 40, 41, and 42 ).A sampling frequency of 10 kHz is used to evaluate acceleration signals for baseline and damaged scenarios and based on the literature,[,][,] an artificial noise (5% of amplitude) is used to pollute the numerical signal for a more realistic reproduction of the measured rail response .", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 34}}
{"text": "artificial noise (5% of amplitude) is used to pollute the numerical signal for a more realistic reproduction of the measured rail response . Then, a low-pass Chebyshev type II digital filter with a cut-off frequency of 500", "metadata": {"doc_id": "713581", "section": "ROOT", "level": 0, "chunk_id": 35}}
